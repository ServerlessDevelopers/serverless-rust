<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-patterns/database-patterns/ddb-basic-stream" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">DynamoDB Streams | Serverless Rust</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://serverless-rust.com/docs/patterns/database-patterns/ddb-basic-stream"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="DynamoDB Streams | Serverless Rust"><meta data-rh="true" name="description" content="Handle table changes with a Lambda"><meta data-rh="true" property="og:description" content="Handle table changes with a Lambda"><meta data-rh="true" name="keywords" content="rust,lambda,dynamodb,change data capture"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://serverless-rust.com/docs/patterns/database-patterns/ddb-basic-stream"><link data-rh="true" rel="alternate" href="https://serverless-rust.com/docs/patterns/database-patterns/ddb-basic-stream" hreflang="en"><link data-rh="true" rel="alternate" href="https://serverless-rust.com/docs/patterns/database-patterns/ddb-basic-stream" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JWKWKGFW71"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JWKWKGFW71",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.fda55b57.css">
<script src="/assets/js/runtime~main.d59cbaa0.js" defer="defer"></script>
<script src="/assets/js/main.599914a0.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Serverless Rust</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/why-rust">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/serverlessdevelopers/serverless-rust/issues" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/why-rust">Why Rust?</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/fundamentals">Fundamentals</a><button aria-label="Expand sidebar category &#x27;Fundamentals&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/getting-started">Getting Started</a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/common-patterns">Common Patterns</a><button aria-label="Collapse sidebar category &#x27;Common Patterns&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/api">API</a><button aria-label="Expand sidebar category &#x27;API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/cicd-1">CI/CD</a><button aria-label="Expand sidebar category &#x27;CI/CD&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/containers">Containers</a><button aria-label="Expand sidebar category &#x27;Containers&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/database">Database</a><button aria-label="Collapse sidebar category &#x27;Database&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/patterns/database-patterns/ddb-basic-operations">DynamoDB Basic Operations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/patterns/database-patterns/ddb-basic-stream">DynamoDB Streams</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/messaging">Messaging</a><button aria-label="Expand sidebar category &#x27;Messaging&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/security">Security</a><button aria-label="Expand sidebar category &#x27;Security&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/common-patterns"><span itemprop="name">Common Patterns</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/database"><span itemprop="name">Database</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">DynamoDB Streams</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>DynamoDB Streams</h1></header><style>[data-ch-theme="dark-plus"] {  --ch-t-colorScheme: dark;--ch-t-foreground: #D4D4D4;--ch-t-background: #1E1E1E;--ch-t-lighter-inlineBackground: #1e1e1ee6;--ch-t-editor-background: #1E1E1E;--ch-t-editor-foreground: #D4D4D4;--ch-t-editor-rangeHighlightBackground: #ffffff0b;--ch-t-editor-infoForeground: #3794FF;--ch-t-editor-selectionBackground: #264F78;--ch-t-focusBorder: #007FD4;--ch-t-tab-activeBackground: #1E1E1E;--ch-t-tab-activeForeground: #ffffff;--ch-t-tab-inactiveBackground: #2D2D2D;--ch-t-tab-inactiveForeground: #ffffff80;--ch-t-tab-border: #252526;--ch-t-tab-activeBorder: #1E1E1E;--ch-t-editorGroup-border: #444444;--ch-t-editorGroupHeader-tabsBackground: #252526;--ch-t-editorLineNumber-foreground: #858585;--ch-t-input-background: #3C3C3C;--ch-t-input-foreground: #D4D4D4;--ch-t-icon-foreground: #C5C5C5;--ch-t-sideBar-background: #252526;--ch-t-sideBar-foreground: #D4D4D4;--ch-t-sideBar-border: #252526;--ch-t-list-activeSelectionBackground: #094771;--ch-t-list-activeSelectionForeground: #fffffe;--ch-t-list-hoverBackground: #2A2D2E; }</style>
<p>Serverless applications often use DynamoDB as their database technology.  DynamoDB handles tremendous scale, provides a simple yet powerful API, is 100% Serverless, and paired with the AWS SDK can be a key piece of an application.  DynamoDB can also serve as the starting point for a powerful architectual pattern called change data capture (CDC).  Change data capture is the process of propogating data changes so that other parts of the application can participate in those changes.  DynamoDB supports CDC by offering the capability called DynamoDB Streams.  Streams can be connected to a Lambda via a trigger or they can be connected to Kinesis.  This pattern below highlights how to handle CDC with DynamoDB via a Lambda trigger.</p>
<h2 id="sample-solution">Sample Solution</h2>
<p>A template for this pattern can be found under the <a href="https://github.com/serverlessdevelopers/serverless-rust/tree/main/templates/patterns/database-patterns/ddb-stream-lambda-handler/">./templates</a> directory in the GitHub repo. You can use the template to get started building with DynamoDB Streams and Lambda.</p>
<p>The record structure that comes from DynamoDB is consistent depending upon the change type that you have configured.  For more details about the shape of the payload, <a href="https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_streams_Record.html">AWS&#x27; documentation</a> can describe the purpose of the fields and definitions.</p>
<p>Below are three main chunks of this sample solution.</p>
<ol>
<li>Main function</li>
<li>Lambda handler code</li>
<li>Parsing the record into a strongly typed struct.</li>
</ol>
<p>Oh, this performs blazingly fast, because it&#x27;s Rust.</p>
<h3 id="main">Main</h3>
<section class="ch-section"><p>Rust programs start off with a <span class="ch-section-link" data-active="false"><code>main</code></span> function.  The main function in this sample includes the <span class="ch-section-link" data-active="false"><code>Tokio</code></span> macro so that this main can run asynchronous code.</p><div class="ch-codeblock not-prose" data-ch-theme="dark-plus"><div class="ch-code-wrapper ch-code" data-ch-measured="false"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>#[tokio::main]</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>async fn main() -&gt; Result&lt;(), Error&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    tracing_subscriber::fmt()</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .with_env_filter(</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            EnvFilter::builder()</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>                .with_default_directive(LevelFilter::INFO.into())</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>                .from_env_lossy(),</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        )</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .json()</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .with_target(false)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .without_time()</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .init();</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    run(service_fn(function_handler)).await</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div></section>
<h3 id="handler">Handler</h3>
<section class="ch-section"><p>The Lambda handler code is executed when events are received and is designed to process a batch of records.  The configuration on the DynamoDB Stream can be set to trigger the Lambda on 1 record or up to 100 records.  Either way, this will be packaged as an array.</p><p>The first piece to note in this handler is that the event argument is typed to an <span class="ch-section-link" data-active="false"><code>event</code></span>.  This event uses the <a href="https://docs.rs/aws_lambda_events/latest/aws_lambda_events/">Lambda events Crate</a> which defines the struct definition for the record definition specified by AWS.</p><div class="ch-codeblock not-prose" data-ch-theme="dark-plus"><div class="ch-code-wrapper ch-code" data-ch-measured="false"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>async fn function_handler(event: LambdaEvent&lt;aws_lambda_events::event::dynamodb::Event&gt;) -&gt; Result&lt;(), Error&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    info!(&quot;(BatchSize)={:?}&quot;, event.payload.records.len());</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    // Extract some useful information from the request</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    for record in event.payload.records {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let m: SampleModel = record.change.new_image.into();</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        info!(&quot;(Sample)={:?}&quot;, m);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    Ok(())</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div><p>The second piece of this handler to highlight is the <span class="ch-section-link" data-active="false"><code>into()</code></span> call on the new_image. This code converts the DynamoDB Stream Record into the <span class="ch-section-link" data-active="false"><code>SampleModel</code></span></p></section>
<h3 id="samplemodel">SampleModel</h3>
<section class="ch-section"><p>One of the interesting things about table design when implementing CDC is that any of your records will trigger the Lambda.  The more varied your items, the more varied your handler will have to be.  This needs to be taken into account when modeling your tables by either overloading keys in a single table design vs using multiple tables to represent your entities.  There&#x27;s no right or wrong, just what is right for your needs.</p><p>For the purposes of this sample, the sample model is defined like this.</p><div class="ch-codeblock not-prose" data-ch-theme="dark-plus"><div class="ch-code-wrapper ch-code" data-ch-measured="false"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>impl From&lt;serde_dynamo::Item&gt; for SampleModel {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    fn from(value: Item) -&gt; Self {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let id_attr = value.get(&quot;Id&quot;);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let message_attr: Option&lt;&amp;AttributeValue&gt; = value.get(&quot;Message&quot;);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let entity_type_attr: Option&lt;&amp;AttributeValue&gt; = value.get(&quot;EntityType&quot;);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let mut id = 0;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let mut message = String::new();</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let mut entity_type = String::new();</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        if let Some(AttributeValue::N(n)) = id_attr {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            if let Ok(i) = n.parse::&lt;i32&gt;() {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>                id = i;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        if let Some(AttributeValue::S(s)) = entity_type_attr {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            entity_type = s.clone();</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        if let Some(AttributeValue::S(s)) = message_attr {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            message = s.clone();</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        SampleModel {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            id,</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            message,</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            entity_type</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div><p>The model includes the <span class="ch-section-link" data-active="false"><code>Serialize, Deserialie, and Debug macros</code></span> which support taking the struct in and out of JSON.</p><p>This struct then implements the <code>into</code> trait in order to provide conversion from the DynamoDB Record into this SampleModel struct.</p><div class="ch-codeblock not-prose" data-ch-theme="dark-plus"><div class="ch-code-wrapper ch-code" data-ch-measured="false"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>impl From&lt;serde_dynamo::Item&gt; for SampleModel {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    fn from(value: Item) -&gt; Self {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let id_attr = value.get(&quot;Id&quot;);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let message_attr: Option&lt;&amp;AttributeValue&gt; = value.get(&quot;Message&quot;);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let entity_type_attr: Option&lt;&amp;AttributeValue&gt; = value.get(&quot;EntityType&quot;);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let mut id = 0;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let mut message = String::new();</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let mut entity_type = String::new();</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        if let Some(AttributeValue::N(n)) = id_attr {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            if let Ok(i) = n.parse::&lt;i32&gt;() {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>                id = i;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        if let Some(AttributeValue::S(s)) = entity_type_attr {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            entity_type = s.clone();</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        if let Some(AttributeValue::S(s)) = message_attr {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            message = s.clone();</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        SampleModel {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            id,</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            message,</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            entity_type</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div></section>
<h2 id="wrapping-up">Wrapping up</h2>
<p>This sample shows a basic implementation of handling an array of DynamoDB Stream Records and how to convert them into a well defined struct.  From this point, the options are endless.</p>
<h2 id="congrats">Congrats</h2>
<p>Congratulations, you now have a starting point to build your Rust Lambdas for processing DynamoDB Change Data Capture Records!</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/patterns/database-patterns/ddb-basic-operations"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">DynamoDB Basic Operations</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/category/messaging"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Messaging</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#sample-solution" class="table-of-contents__link toc-highlight">Sample Solution</a><ul><li><a href="#main" class="table-of-contents__link toc-highlight">Main</a></li><li><a href="#handler" class="table-of-contents__link toc-highlight">Handler</a></li><li><a href="#samplemodel" class="table-of-contents__link toc-highlight">SampleModel</a></li></ul></li><li><a href="#wrapping-up" class="table-of-contents__link toc-highlight">Wrapping up</a></li><li><a href="#congrats" class="table-of-contents__link toc-highlight">Congrats</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/why-rust">Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Built by @plantpowerjames and @benjamenpyle</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/plantpowerjames" target="_blank" rel="noopener noreferrer" class="footer__link-item">@plantpowerjames</a></li><li class="footer__item"><a href="https://twitter.com/benjamenpyle" target="_blank" rel="noopener noreferrer" class="footer__link-item">@benjamenpyle</a></li><li class="footer__item"><a href="https://github.com/serverlessdevelopers/serverless-rust/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Report Issues on GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Serverless Rust. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>
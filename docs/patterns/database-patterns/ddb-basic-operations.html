<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-patterns/database-patterns/ddb-basic-operations" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">DynamoDB Basic Operations | Serverless Rust</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://serverless-rust.com/docs/patterns/database-patterns/ddb-basic-operations"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="DynamoDB Basic Operations | Serverless Rust"><meta data-rh="true" name="description" content="Demonstrate basic DynamoDB operations with the AWS SDK"><meta data-rh="true" property="og:description" content="Demonstrate basic DynamoDB operations with the AWS SDK"><meta data-rh="true" name="keywords" content="rust,lambda,dynamodb,aws,aws sdk,sdk"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://serverless-rust.com/docs/patterns/database-patterns/ddb-basic-operations"><link data-rh="true" rel="alternate" href="https://serverless-rust.com/docs/patterns/database-patterns/ddb-basic-operations" hreflang="en"><link data-rh="true" rel="alternate" href="https://serverless-rust.com/docs/patterns/database-patterns/ddb-basic-operations" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JWKWKGFW71"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JWKWKGFW71",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.fda55b57.css">
<script src="/assets/js/runtime~main.d59cbaa0.js" defer="defer"></script>
<script src="/assets/js/main.599914a0.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Serverless Rust</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/why-rust">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/serverlessdevelopers/serverless-rust/issues" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/why-rust">Why Rust?</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/fundamentals">Fundamentals</a><button aria-label="Expand sidebar category &#x27;Fundamentals&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/getting-started">Getting Started</a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/common-patterns">Common Patterns</a><button aria-label="Collapse sidebar category &#x27;Common Patterns&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/api">API</a><button aria-label="Expand sidebar category &#x27;API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/cicd-1">CI/CD</a><button aria-label="Expand sidebar category &#x27;CI/CD&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/containers">Containers</a><button aria-label="Expand sidebar category &#x27;Containers&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/database">Database</a><button aria-label="Collapse sidebar category &#x27;Database&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/patterns/database-patterns/ddb-basic-operations">DynamoDB Basic Operations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/patterns/database-patterns/ddb-basic-stream">DynamoDB Streams</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/messaging">Messaging</a><button aria-label="Expand sidebar category &#x27;Messaging&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/security">Security</a><button aria-label="Expand sidebar category &#x27;Security&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/common-patterns"><span itemprop="name">Common Patterns</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/database"><span itemprop="name">Database</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">DynamoDB Basic Operations</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>DynamoDB Basic Operations</h1></header><style>[data-ch-theme="dark-plus"] {  --ch-t-colorScheme: dark;--ch-t-foreground: #D4D4D4;--ch-t-background: #1E1E1E;--ch-t-lighter-inlineBackground: #1e1e1ee6;--ch-t-editor-background: #1E1E1E;--ch-t-editor-foreground: #D4D4D4;--ch-t-editor-rangeHighlightBackground: #ffffff0b;--ch-t-editor-infoForeground: #3794FF;--ch-t-editor-selectionBackground: #264F78;--ch-t-focusBorder: #007FD4;--ch-t-tab-activeBackground: #1E1E1E;--ch-t-tab-activeForeground: #ffffff;--ch-t-tab-inactiveBackground: #2D2D2D;--ch-t-tab-inactiveForeground: #ffffff80;--ch-t-tab-border: #252526;--ch-t-tab-activeBorder: #1E1E1E;--ch-t-editorGroup-border: #444444;--ch-t-editorGroupHeader-tabsBackground: #252526;--ch-t-editorLineNumber-foreground: #858585;--ch-t-input-background: #3C3C3C;--ch-t-input-foreground: #D4D4D4;--ch-t-icon-foreground: #C5C5C5;--ch-t-sideBar-background: #252526;--ch-t-sideBar-foreground: #D4D4D4;--ch-t-sideBar-border: #252526;--ch-t-list-activeSelectionBackground: #094771;--ch-t-list-activeSelectionForeground: #fffffe;--ch-t-list-hoverBackground: #2A2D2E; }</style>
<h2 id="introduction">Introduction</h2>
<p>The <a href="../../fundamentals/aws-sdk-rust">AWS SDK for Rust</a> has been developed to simplify operations with various AWS services including <a href="https://docs.rs/aws-sdk-dynamodb/latest/aws_sdk_dynamodb/">DynamoDB</a>.  By leveraging the SDK, you can take advantage of the data plane operations exposed over the API like GetItem, PutItem, Scan and the other core DynamoDB operations.</p>
<p>This article looks to explore the foundational operations that you will encounter when working with AWS, DynamoDB and Rust.  They will be applicable whether you are building and shipping with <a href="/docs/fundamentals/how-lambda-works">Lambda</a> or with Containers.</p>
<h2 id="dynamodb-operations">DynamoDB Operations</h2>
<p>In this article we are going to cover the following operations:</p>
<ul>
<li><a href="#creating-a-client">Creating a DynamoDB SDK client</a></li>
<li><a href="#getitem-request">GetItem</a></li>
<li><a href="#putitem-request">PutItem</a></li>
<li><a href="#updateitem-request">UpdateItem</a></li>
<li><a href="#deleteitem-request">DeleteItem</a></li>
<li><a href="#scan-request">Scan</a></li>
</ul>
<p>Topics not covered but will be in future articles include BatchItem operations, Transactions and Paginiation.</p>
<h3 id="creating-a-client">Creating a Client</h3>
<p>When working with any of the services via the AWS SDK for Rust, you first need to create a client that can interact with its API.  This client is usually shared throughout the lifetime of your service so it&#x27;s essentially a singleton instance.</p>
<p>First, in the Cargo.toml, you need to tell Cargo that you want to bring in the DynamoDB SDK.</p>
<div class="ch-codegroup not-prose" data-ch-theme="dark-plus"><div class="ch-editor-frame"><div class="ch-frame-title-bar"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="Cargo.toml" data-ch-tab="north" data-active="true" class="ch-editor-tab"><div><span style="opacity:0.5"></span>Cargo.toml</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div style="height:100%" class="ch-code-wrapper" data-ch-measured="false"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>[dependencies]</span></div></div><div><div style="display:inline-block;margin-left:16px"><span># more contents omitted for brevity</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>aws-config = { features = [&quot;behavior-version-latest&quot;], version = &quot;1.0.1&quot; }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>aws-sdk-dynamodb = &quot;1.2.0&quot;</span></div></div><br></code></div></div></div></div>
<section class="ch-section"><p>With dependencies pulled in, it&#x27;s time to build a client.</p><p>Two things worth pointing out in the code below.  First up, <span class="ch-section-link" data-active="false">the region</span> needs to be specified.</p><p>The second thing to point out is that this code will allow the client to be <span class="ch-section-link" data-active="false">configured locally</span>.  What this enables is the running of DynamoDB locally or in an integration test in a continuious integration pipeline.</p><div class="ch-codegroup not-prose" data-ch-theme="dark-plus"><div class="ch-editor-frame"><div class="ch-frame-title-bar"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="client.rs" data-ch-tab="north" data-active="true" class="ch-editor-tab"><div><span style="opacity:0.5"></span>client.rs</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div style="height:100%" class="ch-code-wrapper" data-ch-measured="false"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>pub async fn new_client(is_local: String) -&gt; Client {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let region_provider = RegionProviderChain::default_provider()</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .or_else(&quot;us-west-2&quot;);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let sdk_config = aws_config::from_env().region(region_provider).load().await;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    if is_local.to_ascii_lowercase() == &quot;true&quot;.to_string() {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let config = aws_sdk_dynamodb::config::Builder::from(&amp;sdk_config)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            .endpoint_url(&quot;http://localhost:8000&quot;.to_string())</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            .region(Region::from_static(&quot;us-east-1&quot;))</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            .build();</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        return Client::from_conf(config);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let config = aws_sdk_dynamodb::config::Builder::from(&amp;sdk_config).build();</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    Client::from_conf(config)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div></div></div></section>
<h3 id="getitem-request">GetItem Request</h3>
<p>Each of the following sections will have a <a href="https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_GetItem.html">link</a> that references the specific documentation.  The point of this article isn&#x27;t to describe how DynamoDB works, but more to highlight how to operate the functions with the AWS SDK for Rust.</p>
<p>For reference:</p>
<blockquote>
<p>The GetItem operation returns a set of attributes for the item with the given primary key. If there is no matching item, GetItem does not return any data and there will be no Item element in the response. - AWS Documentation</p>
</blockquote>
<section class="ch-section"><p>There are two samples included below that showcase how to execute <span class="ch-section-link" data-active="false"><code>get_item</code></span>.</p><p>The key things to note are that you can specify key as a single partition key or you can use a HashMap to use a compound partition key and range key if the table requires.</p><p>What is really nice about working with item that are returned from DynamoDB, the very familiar serde crate that is used throughout Rust for working with JSON can be used for this data as well which is also JSON.</p><div class="ch-codegroup not-prose" data-ch-theme="dark-plus"><div class="ch-editor-frame"><div class="ch-frame-title-bar"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="get_item_partition_key.rs" data-ch-tab="north" data-active="true" class="ch-editor-tab"><div><span style="opacity:0.5"></span>get_item_partition_key.rs</div></div><div title="get_item_partition_and_range_key.rs" data-ch-tab="north" data-active="false" class="ch-editor-tab"><div><span style="opacity:0.5"></span>get_item_partition_and_range_key.rs</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div style="height:100%" class="ch-code-wrapper" data-ch-measured="false"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>pub async fn fetch_item(client: &amp;Client, table_name: &amp;str, id: &amp;str) -&gt; Result&lt;User, QueryError&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let output = client</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .get_item()</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .key(&quot;id&quot;.to_string(), AttributeValue::S(id.to_string()))</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .table_name(table_name)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .send()</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .await?;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    match output.item {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        Some(item) =&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            let i: BasicEntity = serde_dynamo::from_item(item)?;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            Ok(i)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        },</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        None =&gt; Err(QueryError::NotFound)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div></div></div></section>
<h3 id="putitem-request">PutItem Request</h3>
<p>A PutItem is an update of the entire item that exists in DynamoDB under a specific key.</p>
<blockquote>
<p>Creates a new item, or replaces an old item with a new item. If an item that has the same primary key as the new item already exists in the specified table, the new item completely replaces the existing item. You can perform a conditional put operation (add a new item if one with the specified primary key doesn&#x27;t exist), or replace an existing item if it has certain attribute values. You can return the item&#x27;s attribute values in the same operation, using the ReturnValues parameter. - AWS</p>
</blockquote>
<section class="ch-section"><p>Using PutItem requires that the item&#x27;s attributes be supplied in the request.  Remember, this is a replacement of the item that was there before.  They key is specified as part of the entity as well so you won&#x27;t see a &quot;key&quot; function like on the <a href="#getitem-request">GetItem</a>.</p><div class="ch-codegroup not-prose" data-ch-theme="dark-plus"><div class="ch-editor-frame"><div class="ch-frame-title-bar"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="put_item.rs" data-ch-tab="north" data-active="true" class="ch-editor-tab"><div><span style="opacity:0.5"></span>put_item.rs</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div style="height:100%" class="ch-code-wrapper" data-ch-measured="false"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>pub async fn create_item(</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    client: &amp;Client,</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    table_name: &amp;str,</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    item: BasicEntity,</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>) -&gt; Result&lt;BasicEntity, QueryError&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let _ = client</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .put_item()</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .item(&quot;id&quot;.to_string(), AttributeValue::S(item.get_id()))</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .item(&quot;name&quot;.to_string(), AttributeValue::S(item.get_name()))</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .item(</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            &quot;description&quot;.to_string(),</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            AttributeValue::S(item.get_description()),</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        )</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .item(</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            &quot;entity_type&quot;.to_string(),</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            AttributeValue::S(item.get_entity_type()),</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        )</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .item(</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            &quot;updated_at&quot;.to_string(),</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            AttributeValue::N(item.get_updated_at().to_string()),</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        )</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .item(</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            &quot;created_at&quot;.to_string(),</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            AttributeValue::N(item.get_created_at().to_string()),</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        )</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .table_name(table_name)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .send()</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .await?;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    Ok(item)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div></div></div></section>
<h3 id="updateitem-request">UpdateItem Request</h3>
<p>When you only want to update parts of an item, you can use the UpdateItem request that DynamoDB provides.  It&#x27;s defined like this:</p>
<blockquote>
<p>Edits an existing item&#x27;s attributes, or adds a new item to the table if it does not already exist. You can put, delete, or add attribute values. You can also perform a conditional update on an existing item (insert a new attribute name-value pair if it doesn&#x27;t exist, or replace an existing name-value pair if it has certain expected attribute values). - AWS</p>
</blockquote>
<section class="ch-section"><p>The UpdateItem request uses an <span class="ch-section-link" data-active="false"><code>update_expression</code></span> in combination with the <span class="ch-section-link" data-active="false"><code>expression_attribute_values</code></span> to perform the operation.  The appearance of the <span class="ch-section-link" data-active="false"><code>key</code></span> is also back just like in the <a href="#getitem-request">get_item</a>.</p><div class="ch-codegroup not-prose" data-ch-theme="dark-plus"><div class="ch-editor-frame"><div class="ch-frame-title-bar"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="update_item.rs" data-ch-tab="north" data-active="true" class="ch-editor-tab"><div><span style="opacity:0.5"></span>update_item.rs</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div style="height:100%" class="ch-code-wrapper" data-ch-measured="false"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>pub async fn update_item(client: &amp;Client, table_name: &amp;str, id: &amp;str, timestamp: i64) -&gt; Result&lt;(), QueryError&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let _ = client</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .update_item()</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .table_name(table_name)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .key(&quot;id&quot;, AttributeValue::S(id.to_string()))</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .update_expression(&quot;set updated_at = :updated_at&quot;)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .expression_attribute_values(</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            &quot;:updated_at&quot;,</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            AttributeValue::N(timestamp.to_string()),</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        )</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .send()</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .await?;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    Ok(())</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div></div></div></section>
<h3 id="deleteitem-request">DeleteItem Request</h3>
<p>DeleteItem is used to accomplish just what it describes.  When you want to Delete an Item in DynamoDB.</p>
<blockquote>
<p>Deletes a single item in a table by primary key. You can perform a conditional delete operation that deletes the item if it exists, or if it has an expected attribute value. - AWS</p>
</blockquote>
<section class="ch-section"><p>Using <span class="ch-section-link" data-active="false"><code>delete_item</code></span> will look a lot like <a href="#getitem-request">get_item</a> and <a href="#updateitem-request">update_item</a> in that it uses the <span class="ch-section-link" data-active="false"><code>key</code></span> function.  That key is the only thing that needs to be supplied from a payload standpoint.</p><p>One thing to note is that this is returning <span class="ch-section-link" data-active="false"><code>AllOld</code></span> so that we can determine that the operation was <span class="ch-section-link" data-active="false">successful and the item was found and deleted</span>.</p><div class="ch-codegroup not-prose" data-ch-theme="dark-plus"><div class="ch-editor-frame"><div class="ch-frame-title-bar"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="delete_item.rs" data-ch-tab="north" data-active="true" class="ch-editor-tab"><div><span style="opacity:0.5"></span>delete_item.rs</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div style="height:100%" class="ch-code-wrapper" data-ch-measured="false"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>pub async fn delete_item(client: &amp;Client, table_name: &amp;str, id: &amp;str) -&gt; Result&lt;(), QueryError&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let output = client</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .delete_item()</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .key(&quot;id&quot;.to_string(), AttributeValue::S(id.to_string()))</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .table_name(table_name)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .return_values(aws_sdk_dynamodb::types::ReturnValue::AllOld)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .send()</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .await?;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    match output.attributes() {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        Some(_) =&gt; Ok(()),</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        None =&gt; Err(QueryError::NotFound),</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div></div></div></section>
<h3 id="scan-request">Scan Request</h3>
<p>Scan is sometimes a dirty operation.  It doens&#x27;t leverage any keys and just walks through the table.  In future articles, we will address pagination, but for this example, the below is just a simple Scan operation.</p>
<blockquote>
<p>The Scan operation returns one or more items and item attributes by accessing every item in a table or a secondary index. To have DynamoDB return fewer items, you can provide a FilterExpression operation. - AWS</p>
</blockquote>
<section class="ch-section"><div class="ch-codegroup not-prose" data-ch-theme="dark-plus"><div class="ch-editor-frame"><div class="ch-frame-title-bar"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="scan.rs" data-ch-tab="north" data-active="true" class="ch-editor-tab"><div><span style="opacity:0.5"></span>scan.rs</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div style="height:100%" class="ch-code-wrapper" data-ch-measured="false"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>pub async fn get_items(</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    client: &amp;Client,</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    table_name: &amp;str,</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    limit: i32</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>) -&gt; Result&lt;Vec&lt;BasicEntity&gt;, QueryError&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let output = client</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .scan()</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .limit(limit)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .table_name(table_name)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .send()</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        .await?;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    match output.items {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        Some(item) =&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            let mut entities: Vec&lt;BasicEntity&gt; = Vec::new();</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            for i in item {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>                let entity: Result&lt;BasicEntity, serde_dynamo::Error&gt; = serde_dynamo::from_item(i);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>                match entity {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>                    Ok(entity) =&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>                        entities.push(BasicEntity::from(entity));</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>                    }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>                    Err(e) =&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>                        error!(&quot;(Error)={:?}&quot;, e);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>                    }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>                }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            Ok(entities)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        None =&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>            Ok(Vec::new())</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div></div></div></section>
<h2 id="running-the-sample">Running the Sample</h2>
<p>All of the above operations are available in the sample code found <a href="https://github.com/serverlessdevelopers/serverless-rust/tree/main/templates/patterns/database-patterns/ddb-basic-operations/">./templates</a>.  You will find <a href="#creating-a-client">client building</a> in addition to models, errors and a main function that will execute all of the examples.</p>
<p>In order to execute the code, make sure that you have three things configured:</p>
<ol>
<li>An AWS Account with a DynamoDB created with just a partition key defined as <code>id</code>.</li>
<li>Access locally to read/write/delete items from that DynamoDB table.</li>
<li>An environment variable called <code>TABLE_NAME</code> set to the table name created in item 1.</li>
</ol>
<p>When running the same, you&#x27;ll see the following occur.</p>
<ul>
<li>A loop is run 100 times</li>
<li>An item is created</li>
<li>Then it is fetched</li>
<li>Every 10 items the UpdateItem operation is executed on the <code>updated_at</code> field</li>
<li>At the very end, the table is scanned and items are printed back out to the console</li>
</ul>
<h2 id="congratulations">Congratulations</h2>
<p>Congratulations, you&#x27;ve seen how to establish a new Client with DDB and Rust in addition to the basic data plane operations.  More to come on Pagination, Transactions and BatchItem Operations.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/database"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Database</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/patterns/database-patterns/ddb-basic-stream"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">DynamoDB Streams</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#dynamodb-operations" class="table-of-contents__link toc-highlight">DynamoDB Operations</a><ul><li><a href="#creating-a-client" class="table-of-contents__link toc-highlight">Creating a Client</a></li><li><a href="#getitem-request" class="table-of-contents__link toc-highlight">GetItem Request</a></li><li><a href="#putitem-request" class="table-of-contents__link toc-highlight">PutItem Request</a></li><li><a href="#updateitem-request" class="table-of-contents__link toc-highlight">UpdateItem Request</a></li><li><a href="#deleteitem-request" class="table-of-contents__link toc-highlight">DeleteItem Request</a></li><li><a href="#scan-request" class="table-of-contents__link toc-highlight">Scan Request</a></li></ul></li><li><a href="#running-the-sample" class="table-of-contents__link toc-highlight">Running the Sample</a></li><li><a href="#congratulations" class="table-of-contents__link toc-highlight">Congratulations</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/why-rust">Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Built by @plantpowerjames and @benjamenpyle</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/plantpowerjames" target="_blank" rel="noopener noreferrer" class="footer__link-item">@plantpowerjames</a></li><li class="footer__item"><a href="https://twitter.com/benjamenpyle" target="_blank" rel="noopener noreferrer" class="footer__link-item">@benjamenpyle</a></li><li class="footer__item"><a href="https://github.com/serverlessdevelopers/serverless-rust/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Report Issues on GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Serverless Rust. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>
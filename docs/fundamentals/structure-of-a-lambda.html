<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-fundamentals/structure-of-a-lambda" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Structure of a Lambda function | Serverless Rust</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://serverless-rust.com/docs/fundamentals/structure-of-a-lambda"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Structure of a Lambda function | Serverless Rust"><meta data-rh="true" name="description" content="A walkthrough of the key components of a Lambda function."><meta data-rh="true" property="og:description" content="A walkthrough of the key components of a Lambda function."><meta data-rh="true" name="keywords" content="fundamentals"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://serverless-rust.com/docs/fundamentals/structure-of-a-lambda"><link data-rh="true" rel="alternate" href="https://serverless-rust.com/docs/fundamentals/structure-of-a-lambda" hreflang="en"><link data-rh="true" rel="alternate" href="https://serverless-rust.com/docs/fundamentals/structure-of-a-lambda" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JWKWKGFW71"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JWKWKGFW71",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.fda55b57.css">
<script src="/assets/js/runtime~main.d59cbaa0.js" defer="defer"></script>
<script src="/assets/js/main.599914a0.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Serverless Rust</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/why-rust">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/serverlessdevelopers/serverless-rust/issues" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/why-rust">Why Rust?</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/fundamentals">Fundamentals</a><button aria-label="Collapse sidebar category &#x27;Fundamentals&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fundamentals/aws-sdk-rust">AWS SDK for Rust</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fundamentals/how-lambda-works">How Lambda Works</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/fundamentals/structure-of-a-lambda">Structure of a Lambda function</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fundamentals/networking">Lambda Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fundamentals/invocation-modes">Invocation Methods</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/fundamentals/cargo-toml">Cargo TOML File</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/cicd">CI/CD</a><button aria-label="Expand sidebar category &#x27;CI/CD&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/getting-started">Getting Started</a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/common-patterns">Common Patterns</a><button aria-label="Expand sidebar category &#x27;Common Patterns&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/fundamentals"><span itemprop="name">Fundamentals</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Structure of a Lambda function</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><style>[data-ch-theme="dark-plus"] {  --ch-t-colorScheme: dark;--ch-t-foreground: #D4D4D4;--ch-t-background: #1E1E1E;--ch-t-lighter-inlineBackground: #1e1e1ee6;--ch-t-editor-background: #1E1E1E;--ch-t-editor-foreground: #D4D4D4;--ch-t-editor-rangeHighlightBackground: #ffffff0b;--ch-t-editor-infoForeground: #3794FF;--ch-t-editor-selectionBackground: #264F78;--ch-t-focusBorder: #007FD4;--ch-t-tab-activeBackground: #1E1E1E;--ch-t-tab-activeForeground: #ffffff;--ch-t-tab-inactiveBackground: #2D2D2D;--ch-t-tab-inactiveForeground: #ffffff80;--ch-t-tab-border: #252526;--ch-t-tab-activeBorder: #1E1E1E;--ch-t-editorGroup-border: #444444;--ch-t-editorGroupHeader-tabsBackground: #252526;--ch-t-editorLineNumber-foreground: #858585;--ch-t-input-background: #3C3C3C;--ch-t-input-foreground: #D4D4D4;--ch-t-icon-foreground: #C5C5C5;--ch-t-sideBar-background: #252526;--ch-t-sideBar-foreground: #D4D4D4;--ch-t-sideBar-border: #252526;--ch-t-list-activeSelectionBackground: #094771;--ch-t-list-activeSelectionForeground: #fffffe;--ch-t-list-hoverBackground: #2A2D2E; }</style>
<h1 id="lambda-function-structure">Lambda Function Structure</h1>
<p>Let&#x27;s discuss the structure of a Lambda function built using Rust. We will dive deeper into these topics in later sections.</p>
<style class="ssmq-0">.ssmq-0.ssmq-default{display:block}.ssmq-0:not(.ssmq-default){display: none;}
@media not screen, (max-width: 768px){.ssmq-0.ssmq-notscreenmax-width768px{display:block}.ssmq-0:not(.ssmq-notscreenmax-width768px){display: none;}}</style><div class="ssmq-0 ssmq-notscreenmax-width768px"><section class="ch-scrollycoding-static" data-ch-theme="dark-plus"><h2 id="deserialization">(De)serialization</h2><p>Event payloads are passed to Lambda functions as JSON strings. The Lambda runtime for Rust supports the ability to automatically (de)serialize the Lambda payloads and responses on your behalf.</p><div class="ch-codegroup not-prose" data-ch-theme="dark-plus"><div class="ch-editor-frame"><div class="ch-frame-title-bar"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="main.rs" data-ch-tab="north" data-active="true" class="ch-editor-tab"><div><span style="opacity:0.5"></span>main.rs</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div style="height:100%" class="ch-code-wrapper" data-ch-measured="false"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>use lambda_runtime::{service_fn, tracing, Error, LambdaEvent};</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>use serde::{Deserialize, Serialize};</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>use aws_sdk_dynamodb::{types::AttributeValue, Client};</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>#[tokio::main]</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>async fn main() -&gt; Result&lt;(), Error&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    tracing::init_default_subscriber();</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let config = aws_config::load_from_env().await;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let table_name = env::var(&quot;TABLE_NAME&quot;).expect(&quot;TABLE_NAME must be set&quot;);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let dynamodb_client = Client::new(&amp;config);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    lambda_runtime::run(service_fn(|request: LambdaEvent&lt;Request&gt;| {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let res = function_handler(request, &amp;dynamodb_client).await;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        res</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    Ok(())</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>pub(crate) async fn function_handler(event: LambdaEvent&lt;Request&gt;, client: &amp;Client) -&gt; Result&lt;Response, Error&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let command = event.payload.input_property;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let resp = Response {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        response_id: event.context.request_id,</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    };</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    Ok(resp)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div></div></div><h2 id="initialization">Initialization</h2><p>The <span data-ch-theme="dark-plus" class="ch-inline-code not-prose"><code><span style="color:#DCDCAA">function_handler</span></code></span> method will be called on every invoke. It&#x27;s a good practice in Lambda to initialize any objects that can be re-used outside of the handler. Things like database connections, configuration or loading of any static data.</p><p>Performing this once outside of the handler ensures this code will only execute once per execution environment. In this example, we are initializing the DynamoDB SDK <span data-ch-theme="dark-plus" class="ch-inline-code not-prose"><code><span style="color:#4EC9B0">Client</span></code></span> object in the main function.</p><div class="ch-codegroup not-prose" data-ch-theme="dark-plus"><div class="ch-editor-frame"><div class="ch-frame-title-bar"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="main.rs" data-ch-tab="north" data-active="true" class="ch-editor-tab"><div><span style="opacity:0.5"></span>main.rs</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div style="height:100%" class="ch-code-wrapper" data-ch-measured="false"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>use lambda_runtime::{service_fn, tracing, Error, LambdaEvent};</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>use serde::{Deserialize, Serialize};</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>use aws_sdk_dynamodb::{types::AttributeValue, Client};</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>#[tokio::main]</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>async fn main() -&gt; Result&lt;(), Error&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    tracing::init_default_subscriber();</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let config = aws_config::load_from_env().await;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let table_name = env::var(&quot;TABLE_NAME&quot;).expect(&quot;TABLE_NAME must be set&quot;);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let dynamodb_client = Client::new(&amp;config);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    lambda_runtime::run(service_fn(|request: LambdaEvent&lt;Request&gt;| {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let res = function_handler(request, &amp;dynamodb_client).await;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        res</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    Ok(())</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>pub(crate) async fn function_handler(event: LambdaEvent&lt;Request&gt;, client: &amp;Client) -&gt; Result&lt;Response, Error&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let command = event.payload.input_property;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let resp = Response {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        response_id: event.context.request_id,</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    };</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    Ok(resp)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div></div></div><h2 id="the-event-payload">The Event Payload</h2><p>The <code>LambdaEvent</code> struct used by your <code>function_handler</code> is what the Lambda Rust runtime parses on your behalf. It is a combination of the Event payload passed to Lambda, and the Lambda context. The structure of this payload will change depending if you are using API Gateway, SQS or any of the other Lambda event sources.</p><p>In this example, the Lambda function is being triggered by a custom invoke with a custom input object. In the <code>function_handler</code>, you can access the actual input payload using the <code>payload</code> property.</p><div class="ch-codegroup not-prose" data-ch-theme="dark-plus"><div class="ch-editor-frame"><div class="ch-frame-title-bar"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="main.rs" data-ch-tab="north" data-active="true" class="ch-editor-tab"><div><span style="opacity:0.5"></span>main.rs</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div style="height:100%" class="ch-code-wrapper" data-ch-measured="false"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>use lambda_runtime::{service_fn, tracing, Error, LambdaEvent};</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>use serde::{Deserialize, Serialize};</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>use aws_sdk_dynamodb::{types::AttributeValue, Client};</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>#[tokio::main]</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>async fn main() -&gt; Result&lt;(), Error&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    tracing::init_default_subscriber();</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let config = aws_config::load_from_env().await;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let table_name = env::var(&quot;TABLE_NAME&quot;).expect(&quot;TABLE_NAME must be set&quot;);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let dynamodb_client = Client::new(&amp;config);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    lambda_runtime::run(service_fn(|request: LambdaEvent&lt;Request&gt;| {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let res = function_handler(request, &amp;dynamodb_client).await;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        res</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    Ok(())</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>pub(crate) async fn function_handler(event: LambdaEvent&lt;Request&gt;, client: &amp;Client) -&gt; Result&lt;Response, Error&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let command = event.payload.input_property;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let resp = Response {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        response_id: event.context.request_id,</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    };</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    Ok(resp)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div></div></div><h2 id="the-lambda-context">The Lambda Context</h2><p>The <code>LambdaEvent</code> struct has a second property named <code>context</code>. This property contains <strong>contextual</strong> information about this specific invoke of the function.</p><div class="ch-codegroup not-prose" data-ch-theme="dark-plus"><div class="ch-editor-frame"><div class="ch-frame-title-bar"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="main.rs" data-ch-tab="north" data-active="true" class="ch-editor-tab"><div><span style="opacity:0.5"></span>main.rs</div></div><div style="flex:1;min-width:0.8em"></div></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div style="height:100%" class="ch-code-wrapper" data-ch-measured="false"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>use lambda_runtime::{service_fn, tracing, Error, LambdaEvent};</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>use serde::{Deserialize, Serialize};</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>use aws_sdk_dynamodb::{types::AttributeValue, Client};</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>#[tokio::main]</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>async fn main() -&gt; Result&lt;(), Error&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    tracing::init_default_subscriber();</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let config = aws_config::load_from_env().await;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let table_name = env::var(&quot;TABLE_NAME&quot;).expect(&quot;TABLE_NAME must be set&quot;);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let dynamodb_client = Client::new(&amp;config);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    lambda_runtime::run(service_fn(|request: LambdaEvent&lt;Request&gt;| {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let res = function_handler(request, &amp;dynamodb_client).await;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        res</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    Ok(())</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>pub(crate) async fn function_handler(event: LambdaEvent&lt;Request&gt;, client: &amp;Client) -&gt; Result&lt;Response, Error&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let command = event.payload.input_property;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let resp = Response {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        response_id: event.context.request_id,</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    };</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    Ok(resp)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div></div></div></section></div><div class="ssmq-0 ssmq-default"><section class="ch-scrollycoding" data-ch-theme="dark-plus"><div class="ch-scrollycoding-content"><div class="ch-scrollycoding-step-content" data-selected="true"><h2 id="deserialization">(De)serialization</h2><p>Event payloads are passed to Lambda functions as JSON strings. The Lambda runtime for Rust supports the ability to automatically (de)serialize the Lambda payloads and responses on your behalf.</p></div><div class="ch-scrollycoding-step-content"><h2 id="initialization">Initialization</h2><p>The <span data-ch-theme="dark-plus" class="ch-inline-code not-prose"><code><span style="color:#DCDCAA">function_handler</span></code></span> method will be called on every invoke. It&#x27;s a good practice in Lambda to initialize any objects that can be re-used outside of the handler. Things like database connections, configuration or loading of any static data.</p><p>Performing this once outside of the handler ensures this code will only execute once per execution environment. In this example, we are initializing the DynamoDB SDK <span data-ch-theme="dark-plus" class="ch-inline-code not-prose"><code><span style="color:#4EC9B0">Client</span></code></span> object in the main function.</p></div><div class="ch-scrollycoding-step-content"><h2 id="the-event-payload">The Event Payload</h2><p>The <code>LambdaEvent</code> struct used by your <code>function_handler</code> is what the Lambda Rust runtime parses on your behalf. It is a combination of the Event payload passed to Lambda, and the Lambda context. The structure of this payload will change depending if you are using API Gateway, SQS or any of the other Lambda event sources.</p><p>In this example, the Lambda function is being triggered by a custom invoke with a custom input object. In the <code>function_handler</code>, you can access the actual input payload using the <code>payload</code> property.</p></div><div class="ch-scrollycoding-step-content"><h2 id="the-lambda-context">The Lambda Context</h2><p>The <code>LambdaEvent</code> struct has a second property named <code>context</code>. This property contains <strong>contextual</strong> information about this specific invoke of the function.</p></div></div><div class="ch-scrollycoding-sticker"><div class="ch-codegroup not-prose" data-ch-theme="dark-plus"><div class="ch-editor-frame"><div class="ch-frame-title-bar"><div class="ch-frame-buttons"><div class="ch-frame-button ch-frame-button-left"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-middle"></div><div class="ch-frame-button-space"></div><div class="ch-frame-button ch-frame-button-right"></div></div><div title="main.rs" data-ch-tab="north" data-active="true" class="ch-editor-tab"><div><span style="opacity:0.5"></span>main.rs</div></div><div style="flex:1;min-width:0.8em"></div><button type="button" title="Expand" class="ch-editor-button"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path></svg></button><dialog class="ch-expand-dialog"><button class="ch-expand-close" type="button" title="Close"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></dialog></div><div data-ch-panel="north" style="flex-grow:1;overflow:hidden"><div style="height:100%" class="ch-code-wrapper" data-ch-measured="false"><code class="ch-code-scroll-parent"><br><div><div style="display:inline-block;margin-left:16px"><span>use lambda_runtime::{service_fn, tracing, Error, LambdaEvent};</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>use serde::{Deserialize, Serialize};</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>use aws_sdk_dynamodb::{types::AttributeValue, Client};</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>#[tokio::main]</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>async fn main() -&gt; Result&lt;(), Error&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    tracing::init_default_subscriber();</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let config = aws_config::load_from_env().await;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let table_name = env::var(&quot;TABLE_NAME&quot;).expect(&quot;TABLE_NAME must be set&quot;);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let dynamodb_client = Client::new(&amp;config);</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    lambda_runtime::run(service_fn(|request: LambdaEvent&lt;Request&gt;| {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        let res = function_handler(request, &amp;dynamodb_client).await;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        res</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    Ok(())</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>pub(crate) async fn function_handler(event: LambdaEvent&lt;Request&gt;, client: &amp;Client) -&gt; Result&lt;Response, Error&gt; {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let command = event.payload.input_property;</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    let resp = Response {</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>        response_id: event.context.request_id,</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    };</span></div></div><div><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><div style="display:inline-block;margin-left:16px"><span>    Ok(resp)</span></div></div><div><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div></div></div></div></section></div><script class="ssmq-0">!function(){for(var e=["not screen, (max-width: 768px)","default"],t=["ssmq-notscreenmax-width768px","ssmq-default"],o="ssmq-0",r=document.getElementsByTagName("script"),c=r[r.length-1].parentNode,s=null,a=0;a<e.length-1;a++)if(window.matchMedia(e[a]).matches){s=c.querySelector(":scope > ."+o+"."+t[a]);break}if(!s){var n=t.pop();s=c.querySelector(":scope > ."+o+"."+n)}s.removeAttribute("class"),c.querySelectorAll(":scope > ."+o).forEach((function(e){c.removeChild(e)}))}()</script></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/fundamentals/how-lambda-works"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">How Lambda Works</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/fundamentals/networking"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lambda Networking</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#deserialization" class="table-of-contents__link toc-highlight">(De)serialization</a></li><li><a href="#initialization" class="table-of-contents__link toc-highlight">Initialization</a></li><li><a href="#the-event-payload" class="table-of-contents__link toc-highlight">The Event Payload</a></li><li><a href="#the-lambda-context" class="table-of-contents__link toc-highlight">The Lambda Context</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/why-rust">Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Built by @plantpowerjames and @benjamenpyle</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/plantpowerjames" target="_blank" rel="noopener noreferrer" class="footer__link-item">@plantpowerjames</a></li><li class="footer__item"><a href="https://twitter.com/benjamenpyle" target="_blank" rel="noopener noreferrer" class="footer__link-item">@benjamenpyle</a></li><li class="footer__item"><a href="https://github.com/serverlessdevelopers/serverless-rust/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Report Issues on GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Serverless Rust. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>
"use strict";(self.webpackChunkinteractive_docs=self.webpackChunkinteractive_docs||[]).push([[1718],{7524:(o,t,e)=>{e.r(t),e.d(t,{CH:()=>a,assets:()=>i,chCodeConfig:()=>d,contentTitle:()=>D,default:()=>u,frontMatter:()=>p,metadata:()=>y,toc:()=>C});e(6540);var n=e(4848),s=e(8453),r=e(4754),l=e(3554),c=e.n(l);const p={sidebar_position:3,title:"Web Framework on Lambda",description:"Web Framework on Lambda",keywords:["rust","lambda","api gateway","lambda web adapter"]},D=void 0,y={id:"patterns/api-patterns/web-framework-on-lambda",title:"Web Framework on Lambda",description:"Web Framework on Lambda",source:"@site/docs/patterns/api-patterns/web-framework-on-lambda.mdx",sourceDirName:"patterns/api-patterns",slug:"/patterns/api-patterns/web-framework-on-lambda",permalink:"/docs/patterns/api-patterns/web-framework-on-lambda",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,title:"Web Framework on Lambda",description:"Web Framework on Lambda",keywords:["rust","lambda","api gateway","lambda web adapter"]},sidebar:"tutorialSidebar",previous:{title:"Lambda Function per Verb",permalink:"/docs/patterns/api-patterns/cdk-cargo-lambda-lambda-per-verb-ddb"},next:{title:"CI/CD",permalink:"/docs/category/cicd-1"}},i={},a={annotations:r.hk,Section:r.wn,SectionLink:r.W_,SectionCode:r.bx},d={staticMediaQuery:"not screen, (max-width: 768px)",lineNumbers:void 0,showCopyButton:void 0,themeName:"dark-plus"},C=[{value:"Why Might You Want To Do This?",id:"why-might-you-want-to-do-this",level:2},{value:"API Code",id:"api-code",level:2}];function h(o){const t=Object.assign({p:"p",a:"a",h2:"h2",ol:"ol",li:"li",em:"em",ul:"ul",code:"code"},(0,s.R)(),o.components);return a||A("CH",!1),a.Section||A("CH.Section",!0),a.SectionCode||A("CH.SectionCode",!0),a.SectionLink||A("CH.SectionLink",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("style",{dangerouslySetInnerHTML:{__html:'[data-ch-theme="dark-plus"] {  --ch-t-colorScheme: dark;--ch-t-foreground: #D4D4D4;--ch-t-background: #1E1E1E;--ch-t-lighter-inlineBackground: #1e1e1ee6;--ch-t-editor-background: #1E1E1E;--ch-t-editor-foreground: #D4D4D4;--ch-t-editor-rangeHighlightBackground: #ffffff0b;--ch-t-editor-infoForeground: #3794FF;--ch-t-editor-selectionBackground: #264F78;--ch-t-focusBorder: #007FD4;--ch-t-tab-activeBackground: #1E1E1E;--ch-t-tab-activeForeground: #ffffff;--ch-t-tab-inactiveBackground: #2D2D2D;--ch-t-tab-inactiveForeground: #ffffff80;--ch-t-tab-border: #252526;--ch-t-tab-activeBorder: #1E1E1E;--ch-t-editorGroup-border: #444444;--ch-t-editorGroupHeader-tabsBackground: #252526;--ch-t-editorLineNumber-foreground: #858585;--ch-t-input-background: #3C3C3C;--ch-t-input-foreground: #D4D4D4;--ch-t-icon-foreground: #C5C5C5;--ch-t-sideBar-background: #252526;--ch-t-sideBar-foreground: #D4D4D4;--ch-t-sideBar-border: #252526;--ch-t-list-activeSelectionBackground: #094771;--ch-t-list-activeSelectionForeground: #fffffe;--ch-t-list-hoverBackground: #2A2D2E; }'}}),"\n","\n","\n",(0,n.jsxs)(t.p,{children:["Adopting the ",(0,n.jsx)(t.a,{href:"/docs/patterns/api-patterns/cdk-cargo-lambda-lambda-per-verb-ddb",children:"single Lambda per verb"})," way of building serverless API's with Lambda can be a paradigm shift. If you're a developer familiar with starting up your API on localhost, testing and debugging locally before pushing out to production this shift can be a challenge."]}),"\n",(0,n.jsxs)(t.p,{children:["If this feels like you, then this article walks you through how you can use the ",(0,n.jsx)(t.a,{href:"https://github.com/awslabs/aws-lambda-web-adapter",children:"Lambda Web Adapter"})," alongside the Rocket web framework for Rust to deploy an entire web application to AWS Lambda."]}),"\n",(0,n.jsx)(t.p,{children:"Even though this article uses Rocket, this same process would apply for Actix, Axum or Leptos. Basically, as long as you're using a web framework that can startup on localhost then you're in the right place."}),"\n",(0,n.jsx)(t.h2,{id:"why-might-you-want-to-do-this",children:"Why Might You Want To Do This?"}),"\n",(0,n.jsx)(c(),{controls:!0,url:"https://youtu.be/DUhRpaux4eE"}),"\n",(0,n.jsx)(t.p,{children:"This article isn't going to dive into the nuanced (and potentially controversial) topic of monolithic Lambda's vs having a separate Lambda function per HTTP endpoint and verb. What it will tell you, is why you might want to choose this approach:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsx)(t.li,{children:"A more familiar developer experience"}),"\n",(0,n.jsxs)(t.li,{children:["A lower ",(0,n.jsx)(t.em,{children:"total number"})," of cold starts","\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"If 4 endpoints on your API are called sequentially, you will only see 1 cold start as opposed to 4"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"However, choosing this approach does have it's trade offs:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsx)(t.li,{children:"Slower cold starts. This one is less of a problem with Rust, that starts up quickly anyway. But comparing a single invoke of a web framework on Lambda vs single purpose handlers is almost always going to be slower. Refer to point 2 above for the more nuanced answer to this question"}),"\n",(0,n.jsx)(t.li,{children:"The GET and POST, PUT, DELETE endpoints on your API typically have different security and memory requirements. This approach doesn't allow you to optimise for the specific use case"}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["This article on the ",(0,n.jsx)(t.a,{href:"https://aws.amazon.com/blogs/compute/comparing-design-approaches-for-building-serverless-microservices/",children:"AWS Compute Blog by Luca Mezzalira"})," covers this nuance well. And remember, you can do a combination of both. An API with 10 endpoints could have 9 served by a web framework on Lambda and a single highly optimised endpoint served by a single purpose function. This is the magic of API Gateway + Lambda."]}),"\n",(0,n.jsx)(t.h2,{id:"api-code",children:"API Code"}),"\n",(0,n.jsxs)(a.Section,{codeConfig:d,northPanel:{tabs:["rocket.rs","actix.rs","axum.rs"],active:"rocket.rs",heightRatio:1},files:[{name:"rocket.rs",focus:"",code:{lines:[{tokens:[{content:"#[get(",props:{style:{color:"#D4D4D4"}}},{content:'"/<id>"',props:{style:{color:"#CE9178"}}},{content:")]",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"fn ",props:{style:{color:"#569CD6"}}},{content:"get_by_id",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"id",props:{style:{color:"#9CDCFE"}}},{content:": &",props:{style:{color:"#D4D4D4"}}},{content:"str",props:{style:{color:"#4EC9B0"}}},{content:") -> ",props:{style:{color:"#D4D4D4"}}},{content:"Json",props:{style:{color:"#4EC9B0"}}},{content:"<",props:{style:{color:"#D4D4D4"}}},{content:"ViewModel",props:{style:{color:"#4EC9B0"}}},{content:"> {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    info!",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"id: {:?}"',props:{style:{color:"#CE9178"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"id",props:{style:{color:"#9CDCFE"}}},{content:");",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    // execute the get in the DB",props:{style:{color:"#6A9955"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    let ",props:{style:{color:"#569CD6"}}},{content:"model",props:{style:{color:"#9CDCFE"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"Model",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"new",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"New Model"',props:{style:{color:"#CE9178"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"to_string",props:{style:{color:"#DCDCAA"}}},{content:"());",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    // convert to a view model",props:{style:{color:"#6A9955"}}}]},{tokens:[{content:"    let ",props:{style:{color:"#569CD6"}}},{content:"view_model",props:{style:{color:"#9CDCFE"}}},{content:":",props:{style:{color:"#D4D4D4"}}},{content:"ViewModel",props:{style:{color:"#4EC9B0"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"model",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"into",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    Json",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"view_model",props:{style:{color:"#9CDCFE"}}},{content:")",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"}",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"// Other endpoints removed for brevity...",props:{style:{color:"#6A9955"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"#[launch]",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"fn ",props:{style:{color:"#569CD6"}}},{content:"rocket",props:{style:{color:"#DCDCAA"}}},{content:"() -> ",props:{style:{color:"#D4D4D4"}}},{content:"_",props:{style:{color:"#9CDCFE"}}},{content:" {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    tracing_subscriber",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"fmt",props:{style:{color:"#DCDCAA"}}},{content:"()",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"with_max_level",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"tracing",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"Level",props:{style:{color:"#4EC9B0"}}},{content:"::INFO)",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        // disable printing the name of the module in every log line.",props:{style:{color:"#6A9955"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"with_target",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"false",props:{style:{color:"#569CD6"}}},{content:")",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        // disabling time is handy because CloudWatch will add the ingestion time.",props:{style:{color:"#6A9955"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"without_time",props:{style:{color:"#DCDCAA"}}},{content:"()",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"init",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    rocket",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"build",props:{style:{color:"#DCDCAA"}}},{content:"()",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"mount",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"/"',props:{style:{color:"#CE9178"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"routes!",props:{style:{color:"#DCDCAA"}}},{content:"[",props:{style:{color:"#D4D4D4"}}},{content:"get_by_id",props:{style:{color:"#9CDCFE"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"delete_by_id",props:{style:{color:"#9CDCFE"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"create",props:{style:{color:"#9CDCFE"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"update_by_id",props:{style:{color:"#9CDCFE"}}},{content:"])",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"}",props:{style:{color:"#D4D4D4"}}}]}],lang:"rust"},annotations:[]},{name:"actix.rs",focus:"",code:{lines:[{tokens:[{content:"async fn ",props:{style:{color:"#569CD6"}}},{content:"get_by_id",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"path",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"Path",props:{style:{color:"#4EC9B0"}}},{content:"<",props:{style:{color:"#D4D4D4"}}},{content:"String",props:{style:{color:"#4EC9B0"}}},{content:",>) -> ",props:{style:{color:"#D4D4D4"}}},{content:"HttpResponse",props:{style:{color:"#4EC9B0"}}},{content:" {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    let ",props:{style:{color:"#569CD6"}}},{content:"id",props:{style:{color:"#9CDCFE"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"path",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"into_inner",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    println!",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"{id}"',props:{style:{color:"#CE9178"}}},{content:");",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    // execute the get in the DB",props:{style:{color:"#6A9955"}}}]},{tokens:[{content:"    let ",props:{style:{color:"#569CD6"}}},{content:"model",props:{style:{color:"#9CDCFE"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"Model",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"new",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"New Model"',props:{style:{color:"#CE9178"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"to_string",props:{style:{color:"#DCDCAA"}}},{content:"());",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    // convert to a view model",props:{style:{color:"#6A9955"}}}]},{tokens:[{content:"    let ",props:{style:{color:"#569CD6"}}},{content:"view_model",props:{style:{color:"#9CDCFE"}}},{content:":",props:{style:{color:"#D4D4D4"}}},{content:"ViewModel",props:{style:{color:"#4EC9B0"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"model",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"into",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    HttpResponse",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"Ok",props:{style:{color:"#4EC9B0"}}},{content:"().",props:{style:{color:"#D4D4D4"}}},{content:"json",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"view_model",props:{style:{color:"#9CDCFE"}}},{content:")",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"}",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"// Other endpoints removed for brevity...",props:{style:{color:"#6A9955"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"#[actix_web::main]",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"async fn ",props:{style:{color:"#569CD6"}}},{content:"main",props:{style:{color:"#DCDCAA"}}},{content:"() -> ",props:{style:{color:"#D4D4D4"}}},{content:"std",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"io",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"Result",props:{style:{color:"#4EC9B0"}}},{content:"<()> {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    env_logger",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"init_from_env",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"env_logger",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"Env",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"new",props:{style:{color:"#DCDCAA"}}},{content:"().",props:{style:{color:"#D4D4D4"}}},{content:"default_filter_or",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"info"',props:{style:{color:"#CE9178"}}},{content:"));",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    log",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"info!",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"starting HTTP server at http://localhost:8080"',props:{style:{color:"#CE9178"}}},{content:");",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    HttpServer",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"new",props:{style:{color:"#DCDCAA"}}},{content:"(|| {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        App",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"new",props:{style:{color:"#DCDCAA"}}},{content:"()",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            // enable logger",props:{style:{color:"#6A9955"}}}]},{tokens:[{content:"            .",props:{style:{color:"#D4D4D4"}}},{content:"wrap",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"middleware",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"Logger",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"default",props:{style:{color:"#DCDCAA"}}},{content:"())",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            .",props:{style:{color:"#D4D4D4"}}},{content:"service",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"web",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"resource",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"/"',props:{style:{color:"#CE9178"}}},{content:")",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"                .",props:{style:{color:"#D4D4D4"}}},{content:"route",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"post",props:{style:{color:"#DCDCAA"}}},{content:"().",props:{style:{color:"#D4D4D4"}}},{content:"to",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"create",props:{style:{color:"#9CDCFE"}}},{content:")))",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            .",props:{style:{color:"#D4D4D4"}}},{content:"service",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"web",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"resource",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"/{id}"',props:{style:{color:"#CE9178"}}},{content:")",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"                .",props:{style:{color:"#D4D4D4"}}},{content:"route",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"get",props:{style:{color:"#DCDCAA"}}},{content:"().",props:{style:{color:"#D4D4D4"}}},{content:"to",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"get_by_id",props:{style:{color:"#9CDCFE"}}},{content:"))",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"                .",props:{style:{color:"#D4D4D4"}}},{content:"route",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"delete",props:{style:{color:"#DCDCAA"}}},{content:"().",props:{style:{color:"#D4D4D4"}}},{content:"to",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"delete_by_id",props:{style:{color:"#9CDCFE"}}},{content:"))",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            )",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    })",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"bind",props:{style:{color:"#DCDCAA"}}},{content:"((",props:{style:{color:"#D4D4D4"}}},{content:'"127.0.0.1"',props:{style:{color:"#CE9178"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"8080",props:{style:{color:"#B5CEA8"}}},{content:"))?",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"run",props:{style:{color:"#DCDCAA"}}},{content:"()",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"await",props:{style:{color:"#C586C0"}}}]},{tokens:[{content:"}",props:{style:{color:"#D4D4D4"}}}]}],lang:"rust"},annotations:[]},{name:"axum.rs",focus:"",code:{lines:[{tokens:[{content:"async fn ",props:{style:{color:"#569CD6"}}},{content:"get_by_id",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"Path",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"id",props:{style:{color:"#9CDCFE"}}},{content:"): ",props:{style:{color:"#D4D4D4"}}},{content:"Path",props:{style:{color:"#4EC9B0"}}},{content:"<",props:{style:{color:"#D4D4D4"}}},{content:"String",props:{style:{color:"#4EC9B0"}}},{content:">) -> ",props:{style:{color:"#D4D4D4"}}},{content:"Json",props:{style:{color:"#4EC9B0"}}},{content:"<",props:{style:{color:"#D4D4D4"}}},{content:"ViewModel",props:{style:{color:"#4EC9B0"}}},{content:"> {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    println!",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"{id}"',props:{style:{color:"#CE9178"}}},{content:");",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    // execute the get in the DB",props:{style:{color:"#6A9955"}}}]},{tokens:[{content:"    let ",props:{style:{color:"#569CD6"}}},{content:"model",props:{style:{color:"#9CDCFE"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"Model",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"new",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"New Model"',props:{style:{color:"#CE9178"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"to_string",props:{style:{color:"#DCDCAA"}}},{content:"());",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    // convert to a view model",props:{style:{color:"#6A9955"}}}]},{tokens:[{content:"    let ",props:{style:{color:"#569CD6"}}},{content:"view_model",props:{style:{color:"#9CDCFE"}}},{content:":",props:{style:{color:"#D4D4D4"}}},{content:"ViewModel",props:{style:{color:"#4EC9B0"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"model",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"into",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    Json",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"view_model",props:{style:{color:"#9CDCFE"}}},{content:")",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"}",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"#[tokio::main]",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"async fn ",props:{style:{color:"#569CD6"}}},{content:"main",props:{style:{color:"#DCDCAA"}}},{content:"() -> ",props:{style:{color:"#D4D4D4"}}},{content:"std",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"io",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"Result",props:{style:{color:"#4EC9B0"}}},{content:"<()> {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    // initialize tracing",props:{style:{color:"#6A9955"}}}]},{tokens:[{content:"    tracing_subscriber",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"fmt",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"init",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    // build our application with a route",props:{style:{color:"#6A9955"}}}]},{tokens:[{content:"    let ",props:{style:{color:"#569CD6"}}},{content:"app",props:{style:{color:"#9CDCFE"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"Router",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"new",props:{style:{color:"#DCDCAA"}}},{content:"()",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"route",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"/"',props:{style:{color:"#CE9178"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"get",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"create",props:{style:{color:"#9CDCFE"}}},{content:"))",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"route",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"/:id"',props:{style:{color:"#CE9178"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"get",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"get_by_id",props:{style:{color:"#9CDCFE"}}},{content:"))",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"route",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"/:id"',props:{style:{color:"#CE9178"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"post",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"create",props:{style:{color:"#9CDCFE"}}},{content:"))",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"route",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"/:id"',props:{style:{color:"#CE9178"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"put",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"update",props:{style:{color:"#9CDCFE"}}},{content:"));",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    // run our app with hyper, listening globally on port 3000",props:{style:{color:"#6A9955"}}}]},{tokens:[{content:"    let ",props:{style:{color:"#569CD6"}}},{content:"listener",props:{style:{color:"#9CDCFE"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"tokio",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"net",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"TcpListener",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"bind",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"0.0.0.0:8080"',props:{style:{color:"#CE9178"}}},{content:").",props:{style:{color:"#D4D4D4"}}},{content:"await",props:{style:{color:"#C586C0"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"unwrap",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    axum",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"serve",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"listener",props:{style:{color:"#9CDCFE"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"app",props:{style:{color:"#9CDCFE"}}},{content:").",props:{style:{color:"#D4D4D4"}}},{content:"await",props:{style:{color:"#C586C0"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"unwrap",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    Ok",props:{style:{color:"#4EC9B0"}}},{content:"(())",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"}",props:{style:{color:"#D4D4D4"}}}]}],lang:"rust"},annotations:[]}],children:[(0,n.jsx)(t.p,{children:"Looking at the application code, you'll notice it looks just like a standard API. There are currently samples demonstrating:"}),(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://github.com/jeastham1993/serverless-rust.github.io/tree/main/templates/patterns/api-patterns/rocket-on-lambda/",children:"Rocket"}),": ",(0,n.jsxs)(a.SectionLink,{file:"rocket.rs",focus:"16:28",id:"focus://rocket.rs#16:28",children:[(0,n.jsx)(t.code,{children:"rocket()"})," function"]})," starts up a Rocket web application and the respective routes are mounted"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://github.com/jeastham1993/serverless-rust.github.io/tree/main/templates/patterns/api-patterns/actix-on-lambda/",children:"Actix Web"}),": ",(0,n.jsxs)(a.SectionLink,{file:"actix.rs",focus:"15:34",id:"focus://actix.rs#15:34",children:[(0,n.jsx)(t.code,{children:"main()"})," function"]})," starts up an Actix web application and the respective routes are mounted"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://github.com/jeastham1993/serverless-rust.github.io/tree/main/templates/patterns/api-patterns/axum-on-lambda/",children:"Axum"}),": ",(0,n.jsxs)(a.SectionLink,{file:"axum.rs",focus:"12:28",id:"focus://axum.rs#12:28",children:[(0,n.jsx)(t.code,{children:"main()"})," function"]})," starts up an Axum web application and the respective routes are mounted"]}),"\n"]}),(0,n.jsxs)(a.SectionCode,{children:[(0,n.jsx)(a.SectionCode,{}),(0,n.jsx)(a.SectionCode,{}),(0,n.jsx)(a.SectionCode,{})]}),(0,n.jsx)(t.p,{children:"As long as this code starts up on a local port, this code will run."})]}),"\n",(0,n.jsxs)(a.Section,{codeConfig:d,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"Resources",props:{style:{color:"#569CD6"}}},{content:":",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"  RocketWebFunction",props:{style:{color:"#569CD6"}}},{content:":",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    Type",props:{style:{color:"#569CD6"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"AWS::Serverless::Function",props:{style:{color:"#CE9178"}}}]},{tokens:[{content:"    Properties",props:{style:{color:"#569CD6"}}},{content:":",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"      CodeUri",props:{style:{color:"#569CD6"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:".",props:{style:{color:"#B5CEA8"}}}]},{tokens:[{content:"      Handler",props:{style:{color:"#569CD6"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"bootstrap",props:{style:{color:"#CE9178"}}}]},{tokens:[{content:"      Runtime",props:{style:{color:"#569CD6"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"provided.al2023",props:{style:{color:"#CE9178"}}}]},{tokens:[{content:"      Architectures",props:{style:{color:"#569CD6"}}},{content:":",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        - ",props:{style:{color:"#D4D4D4"}}},{content:"arm64",props:{style:{color:"#CE9178"}}}]},{tokens:[{content:"      Environment",props:{style:{color:"#569CD6"}}},{content:":",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        Variables",props:{style:{color:"#569CD6"}}},{content:":",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"          AWS_LWA_PORT",props:{style:{color:"#569CD6"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"8000",props:{style:{color:"#B5CEA8"}}}]},{tokens:[{content:"      Layers",props:{style:{color:"#569CD6"}}},{content:":",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        - ",props:{style:{color:"#D4D4D4"}}},{content:"!Sub ",props:{style:{color:"#569CD6"}}},{content:"arn:aws:lambda:${AWS::Region}:753240598075:layer:LambdaAdapterLayerArm64:20",props:{style:{color:"#CE9178"}}}]},{tokens:[{content:"      Events",props:{style:{color:"#569CD6"}}},{content:":",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        Api",props:{style:{color:"#569CD6"}}},{content:":",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"          Type",props:{style:{color:"#569CD6"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"HttpApi",props:{style:{color:"#CE9178"}}}]},{tokens:[{content:"          Properties",props:{style:{color:"#569CD6"}}},{content:":",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            Path",props:{style:{color:"#569CD6"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"/{proxy+}",props:{style:{color:"#CE9178"}}}]},{tokens:[{content:"            Method",props:{style:{color:"#569CD6"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"ANY",props:{style:{color:"#CE9178"}}}]},{tokens:[{content:"    Metadata",props:{style:{color:"#569CD6"}}},{content:":",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"      BuildMethod",props:{style:{color:"#569CD6"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"rust-cargolambda",props:{style:{color:"#CE9178"}}}]}],lang:"yaml"},annotations:[]}],children:[(0,n.jsxs)(t.p,{children:["This is all made possible by the ",(0,n.jsx)(t.a,{href:"https://github.com/awslabs/aws-lambda-web-adapter",children:"Lambda Web Adapter"})," (LWA). LWA runs as a layer alongside your Lambda function. It's job is to take the incoming request payload and use that to make a HTTP request to your web application running inside the Lambda environment."]}),(0,n.jsx)(t.p,{children:"You can think of LWA as a proxy/translation layer."}),(0,n.jsxs)(t.p,{children:["You'll also notice that the ",(0,n.jsx)(a.SectionLink,{focus:"10:12",id:"focus://10:12",children:"AWS_LWA_PORT"})," environment variable is being set to 8000. This is because the Rocket web application starts up on port 8080. LWA defaults to port 8080, so if you're application starts up on 8080 you don't need to set this variable."]}),(0,n.jsx)(a.SectionCode,{})]}),"\n",(0,n.jsx)(t.p,{children:"And that is all there is to deploying an entire web API to AWS Lambda. And although you are running a slightly more monolithic Lambda, don't take that as a signal to add hundreds of endpoints to your API running inside Lambda. Still practice microservices, and break things down into smaller chunks."})]})}const u=function(o={}){const{wrapper:t}=Object.assign({},(0,s.R)(),o.components);return t?(0,n.jsx)(t,Object.assign({},o,{children:(0,n.jsx)(h,o)})):h(o)};function A(o,t){throw new Error("Expected "+(t?"component":"object")+" `"+o+"` to be defined: you likely forgot to import, pass, or provide it.")}}}]);
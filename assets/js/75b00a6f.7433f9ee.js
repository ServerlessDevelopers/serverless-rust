"use strict";(self.webpackChunkinteractive_docs=self.webpackChunkinteractive_docs||[]).push([[5468],{9029:(e,n,t)=>{t.r(n),t.d(n,{CH:()=>u,assets:()=>d,chCodeConfig:()=>h,contentTitle:()=>s,default:()=>g,frontMatter:()=>i,metadata:()=>c,toc:()=>l});t(6540);var o=t(4848),a=t(8453),r=t(4754);const i={sidebar_position:3,title:"Lambda Networking",description:"A walkthrough of how networking works in AWS Lambda.",keywords:["fundamentals"]},s="Lambda Networking",c={id:"fundamentals/networking",title:"Lambda Networking",description:"A walkthrough of how networking works in AWS Lambda.",source:"@site/docs/fundamentals/networking.md",sourceDirName:"fundamentals",slug:"/fundamentals/networking",permalink:"/docs/fundamentals/networking",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,title:"Lambda Networking",description:"A walkthrough of how networking works in AWS Lambda.",keywords:["fundamentals"]},sidebar:"tutorialSidebar",previous:{title:"Structure of a Lambda function",permalink:"/docs/fundamentals/structure-of-a-lambda"},next:{title:"Invocation Methods",permalink:"/docs/fundamentals/invocation-modes"}},d={},l=[{value:"Considerations",id:"considerations",level:2},{value:"Further Reading",id:"further-reading",level:3}],u={annotations:r.hk,InlineCode:r.R0},h={staticMediaQuery:"not screen, (max-width: 768px)",lineNumbers:void 0,showCopyButton:void 0,themeName:"dark-plus"};function f(e){const n=Object.assign({h1:"h1",p:"p",img:"img",strong:"strong",a:"a",h2:"h2",h3:"h3",ul:"ul",li:"li"},(0,a.R)(),e.components);return u||p("CH",!1),u.InlineCode||p("CH.InlineCode",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("style",{dangerouslySetInnerHTML:{__html:'[data-ch-theme="dark-plus"] {  --ch-t-colorScheme: dark;--ch-t-foreground: #D4D4D4;--ch-t-background: #1E1E1E;--ch-t-lighter-inlineBackground: #1e1e1ee6;--ch-t-editor-background: #1E1E1E;--ch-t-editor-foreground: #D4D4D4;--ch-t-editor-rangeHighlightBackground: #ffffff0b;--ch-t-editor-infoForeground: #3794FF;--ch-t-editor-selectionBackground: #264F78;--ch-t-focusBorder: #007FD4;--ch-t-tab-activeBackground: #1E1E1E;--ch-t-tab-activeForeground: #ffffff;--ch-t-tab-inactiveBackground: #2D2D2D;--ch-t-tab-inactiveForeground: #ffffff80;--ch-t-tab-border: #252526;--ch-t-tab-activeBorder: #1E1E1E;--ch-t-editorGroup-border: #444444;--ch-t-editorGroupHeader-tabsBackground: #252526;--ch-t-editorLineNumber-foreground: #858585;--ch-t-input-background: #3C3C3C;--ch-t-input-foreground: #D4D4D4;--ch-t-icon-foreground: #C5C5C5;--ch-t-sideBar-background: #252526;--ch-t-sideBar-foreground: #D4D4D4;--ch-t-sideBar-border: #252526;--ch-t-list-activeSelectionBackground: #094771;--ch-t-list-activeSelectionForeground: #fffffe;--ch-t-list-hoverBackground: #2A2D2E; }'}}),"\n",(0,o.jsx)(n.h1,{id:"lambda-networking",children:"Lambda Networking"}),"\n",(0,o.jsx)(n.p,{children:"Many of you will have existing 'server-full' applications that run within a VPC on AWS. To connect your Lambda functions to these applications it's important to understand how networking works in Lambda."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{src:t(8361).A+"",loading:"lazy",alt:"Lambda networking diagram",width:"751",height:"770"})}),"\n",(0,o.jsxs)(n.p,{children:["When configuring your Lambda function there is an option to set a range of ",(0,o.jsx)(u.InlineCode,{codeConfig:h,code:{lines:[{tokens:[{content:"SubnetIds",props:{style:{color:"#9CDCFE"}}}]}],lang:"jsx"},children:"SubnetIds"})," and a ",(0,o.jsx)(u.InlineCode,{codeConfig:h,code:{lines:[{tokens:[{content:"SecurityGroupId",props:{style:{color:"#9CDCFE"}}}]}],lang:"jsx"},children:"SecurityGroupId"}),". These settings configure the entrypoint for Lambda network traffic. However, Your Lambda functions ",(0,o.jsx)(n.strong,{children:"always"})," run within a Lambda service owned VPC! Yep, that's right. When you configure the network settings that doesn't mean the function will run within your account."]}),"\n",(0,o.jsxs)(n.p,{children:["Instead, an ",(0,o.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-eni.html",children:"Elastic Network Interface (ENI)"})," is created in the ",(0,o.jsx)(u.InlineCode,{codeConfig:h,code:{lines:[{tokens:[{content:"Subnets",props:{style:{color:"#9CDCFE"}}}]}],lang:"jsx"},children:"Subnets"})," and ",(0,o.jsx)(u.InlineCode,{codeConfig:h,code:{lines:[{tokens:[{content:"SecurityGroups",props:{style:{color:"#9CDCFE"}}}]}],lang:"jsx"},children:"SecurityGroups"})," you specified. This ENI provides a connection back to the Lambda service VPC through a Hyperplane ",(0,o.jsx)(n.a,{href:"https://docs.aws.amazon.com/vpc/latest/userguide/vpc-nat-gateway.html",children:"NAT Gateway"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"considerations",children:"Considerations"}),"\n",(0,o.jsxs)(n.p,{children:["The ENI deployed into your account ",(0,o.jsx)(n.strong,{children:"will"})," use an IP address out of the available IP's in the specified ",(0,o.jsx)(u.InlineCode,{codeConfig:h,code:{lines:[{tokens:[{content:"Subnet",props:{style:{color:"#9CDCFE"}}}]}],lang:"jsx"},children:"Subnet"}),". Lambda will use 1 IP address per function. If you have 1000 invocations and 9 versions that will still only use a single ENI and IP address. Without careful management it's easy to exhaust the IP range in your subnets. I'd suggest having a subnet and IP block specifically for Lambda."]}),"\n",(0,o.jsxs)(n.p,{children:["Now that all network traffic leaving your function will run through the ",(0,o.jsx)(u.InlineCode,{codeConfig:h,code:{lines:[{tokens:[{content:"Subnet",props:{style:{color:"#9CDCFE"}}}]}],lang:"jsx"},children:"Subnet"})," specified all of that traffic is at the mercy of your network. Security groups, NACL's, route tables can all affect the functionality of your application. If your function code needs to talk to a public AWS service (S3 for example) or a 3rd party API you need to ensure the network routes are available."]}),"\n",(0,o.jsxs)(n.p,{children:["Finally, you need to consider Lambda scaling and how that will affect your server-full resources. Databases are the common challenge. Lambda, as a default, will scale up to 1,000 concurrent executions. This may mean 1,000 concurrent connections to your database. There are ways to protect against that with services like ",(0,o.jsx)(n.a,{href:"https://aws.amazon.com/rds/proxy/",children:"RDS Proxy"}),", but more on that later. For now, just consider how your existing resources will cope with Lambda's fast scaling."]}),"\n",(0,o.jsx)(n.h3,{id:"further-reading",children:"Further Reading"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://aws.amazon.com/blogs/compute/announcing-improved-vpc-networking-for-aws-lambda-functions/",children:"Improved Networking for AWS Lambda functions, AWS Blog"})}),"\n"]})]})}const g=function(e={}){const{wrapper:n}=Object.assign({},(0,a.R)(),e.components);return n?(0,o.jsx)(n,Object.assign({},e,{children:(0,o.jsx)(f,e)})):f(e)};function p(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},8361:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/lambda-networking-5c5e541b087f81ecdb71960fe2cb8f13.png"}}]);
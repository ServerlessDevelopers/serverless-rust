"use strict";(self.webpackChunkinteractive_docs=self.webpackChunkinteractive_docs||[]).push([[3774],{6228:(o,e,t)=>{t.r(e),t.d(e,{CH:()=>d,assets:()=>a,chCodeConfig:()=>y,contentTitle:()=>i,default:()=>C,frontMatter:()=>p,metadata:()=>D,toc:()=>h});t(6540);var s=t(4848),n=t(8453),r=t(4754),c=t(3554),l=t.n(c);const p={sidebar_position:5,title:"Kinesis Message Processor",description:"Lambda function for processing messages from a Kinesis stream",keywords:["rust","lambda","kinesis","messaging","streaming data"]},i=void 0,D={id:"patterns/messaging-patterns/sam-lambda-kinesis-message-processor",title:"Kinesis Message Processor",description:"Lambda function for processing messages from a Kinesis stream",source:"@site/docs/patterns/messaging-patterns/sam-lambda-kinesis-message-processor.mdx",sourceDirName:"patterns/messaging-patterns",slug:"/patterns/messaging-patterns/sam-lambda-kinesis-message-processor",permalink:"/docs/patterns/messaging-patterns/sam-lambda-kinesis-message-processor",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5,title:"Kinesis Message Processor",description:"Lambda function for processing messages from a Kinesis stream",keywords:["rust","lambda","kinesis","messaging","streaming data"]},sidebar:"tutorialSidebar",previous:{title:"SNS Message Processor",permalink:"/docs/patterns/messaging-patterns/sam-lambda-sns-topic-processor"},next:{title:"Security",permalink:"/docs/category/security"}},a={},d={annotations:r.hk,Code:r.Cy,Section:r.wn,SectionLink:r.W_,SectionCode:r.bx,Scrollycoding:r.Fk,CodeSlot:r.Wu},y={staticMediaQuery:"not screen, (max-width: 768px)",lineNumbers:void 0,showCopyButton:void 0,themeName:"dark-plus"},h=[{value:"Video Walkthrough",id:"video-walkthrough",level:2},{value:"How It Works",id:"how-it-works",level:2},{value:"Project Structure",id:"project-structure",level:2},{value:"Lambda Code",id:"lambda-code",level:2},{value:"Shared Code &amp; Reusability",id:"shared-code--reusability",level:2},{value:"Deploy Your Own",id:"deploy-your-own",level:2}];function u(o){const e=Object.assign({p:"p",h2:"h2",a:"a",code:"code"},(0,n.R)(),o.components);return d||m("CH",!1),d.Code||m("CH.Code",!0),d.CodeSlot||m("CH.CodeSlot",!0),d.Scrollycoding||m("CH.Scrollycoding",!0),d.Section||m("CH.Section",!0),d.SectionCode||m("CH.SectionCode",!0),d.SectionLink||m("CH.SectionLink",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("style",{dangerouslySetInnerHTML:{__html:'[data-ch-theme="dark-plus"] {  --ch-t-colorScheme: dark;--ch-t-foreground: #D4D4D4;--ch-t-background: #1E1E1E;--ch-t-lighter-inlineBackground: #1e1e1ee6;--ch-t-editor-background: #1E1E1E;--ch-t-editor-foreground: #D4D4D4;--ch-t-editor-rangeHighlightBackground: #ffffff0b;--ch-t-editor-infoForeground: #3794FF;--ch-t-editor-selectionBackground: #264F78;--ch-t-focusBorder: #007FD4;--ch-t-tab-activeBackground: #1E1E1E;--ch-t-tab-activeForeground: #ffffff;--ch-t-tab-inactiveBackground: #2D2D2D;--ch-t-tab-inactiveForeground: #ffffff80;--ch-t-tab-border: #252526;--ch-t-tab-activeBorder: #1E1E1E;--ch-t-editorGroup-border: #444444;--ch-t-editorGroupHeader-tabsBackground: #252526;--ch-t-editorLineNumber-foreground: #858585;--ch-t-input-background: #3C3C3C;--ch-t-input-foreground: #D4D4D4;--ch-t-icon-foreground: #C5C5C5;--ch-t-sideBar-background: #252526;--ch-t-sideBar-foreground: #D4D4D4;--ch-t-sideBar-border: #252526;--ch-t-list-activeSelectionBackground: #094771;--ch-t-list-activeSelectionForeground: #fffffe;--ch-t-list-hoverBackground: #2A2D2E; }'}}),"\n","\n","\n",(0,s.jsx)(e.p,{children:"With the explosion of data streaming, whether that be readings from IoT sensors or events in an event driven architectures, the amount of data moving around in your organisation is probably increasing. As this volume continues to grow, your ability to process records from the stream quickly and efficiently is going to have a direct impact on the cost and scalability of your system."}),"\n",(0,s.jsx)(e.p,{children:"Amazon Kinesis is a serverless streaming service provided by AWS. It allows producers to put messages onto the stream and services like AWS Lambda and Amazon Event Bridge Pipes can be added as consumers of records on the stream."}),"\n",(0,s.jsx)(e.h2,{id:"video-walkthrough",children:"Video Walkthrough"}),"\n",(0,s.jsx)(e.p,{children:"If video is more your thing, then check out this walkthrough on YouTube. Otherwise, keep reading for the written documentation."}),"\n",(0,s.jsx)(l(),{controls:!0,url:"https://youtu.be/yd0iUPMG-DM"}),"\n",(0,s.jsx)(e.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,s.jsxs)(e.p,{children:["The Kinesis to Lambda integration is an example of a ",(0,s.jsx)(e.a,{href:"/docs/fundamentals/invocation-modes#poll-based-invokes",children:"poll based invoke"}),". Internally, the Lambda service polls the Kinesis stream on your behalf and invokes your Lambda function with a batch of messages. As a developer, that means you need to write your Lambda functions to handle a batch of messages."]}),"\n",(0,s.jsx)(e.p,{children:"This integration ensures you, as a developer, don't need to worry about the last read location of the stream. And the Lambda Event Source supports partial completions. Meaning if only 10 of the 20 messages in the current batch are processed successfully, the stream location will not move forward."}),"\n",(0,s.jsx)(e.h2,{id:"project-structure",children:"Project Structure"}),"\n",(0,s.jsxs)(e.p,{children:["A Kinesis to Lambda template is found under the ",(0,s.jsx)(e.a,{href:"https://github.com/serverlessdevelopers/serverless-rust/templates/patterns/messaging-patterns/kinesis-message-processor",children:"./templates"})," directory in the GitHub repo. You can use template to get started building with SQS and Lambda."]}),"\n",(0,s.jsx)(e.p,{children:"The project separates the Kinesis processing code from your business logic. This allows you to share domain code between multiple Lambda functions that are contained within the same service."}),"\n",(0,s.jsx)(d.Code,{codeConfig:y,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"lambdas",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"  - ",props:{style:{color:"#D4D4D4"}}},{content:"new-message-processor",props:{style:{color:"#CE9178"}}}]},{tokens:[{content:"  - ",props:{style:{color:"#D4D4D4"}}},{content:"shared",props:{style:{color:"#CE9178"}}}]}],lang:"bash"},annotations:[]}]}),"\n",(0,s.jsxs)(e.p,{children:["This tutorial will mostly focus on the code under ",(0,s.jsx)(e.code,{children:"lambdas/new-message-processor"}),". Although shared code will be referenced to discuss how you can take this template and 'plug-in' your own implementation."]}),"\n",(0,s.jsx)(e.h2,{id:"lambda-code",children:"Lambda Code"}),"\n",(0,s.jsxs)(d.Section,{codeConfig:y,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"#[tokio::main]",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"async fn ",props:{style:{color:"#569CD6"}}},{content:"main",props:{style:{color:"#DCDCAA"}}},{content:"() -> ",props:{style:{color:"#D4D4D4"}}},{content:"Result",props:{style:{color:"#4EC9B0"}}},{content:"<(), ",props:{style:{color:"#D4D4D4"}}},{content:"Error",props:{style:{color:"#4EC9B0"}}},{content:"> {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    tracing_subscriber",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"fmt",props:{style:{color:"#DCDCAA"}}},{content:"()",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"with_max_level",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"tracing",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"Level",props:{style:{color:"#4EC9B0"}}},{content:"::INFO)",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"with_target",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"false",props:{style:{color:"#569CD6"}}},{content:")",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"without_time",props:{style:{color:"#DCDCAA"}}},{content:"()",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"init",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    run",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"service_fn",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"function_handler",props:{style:{color:"#9CDCFE"}}},{content:")).",props:{style:{color:"#D4D4D4"}}},{content:"await",props:{style:{color:"#C586C0"}}}]},{tokens:[{content:"}",props:{style:{color:"#D4D4D4"}}}]}],lang:"rust"},annotations:[]}],children:[(0,s.jsxs)(e.p,{children:["Whenever you are working with Kinesis and Lambda your ",(0,s.jsx)(d.SectionLink,{focus:"2[10:14]",id:"focus://2[10:14]",children:(0,s.jsx)(e.code,{children:"main"})})," function will look the same. This example doesn't focus on initializing AWS SDK's or reusable code. However, inside the main method is where you would normally initialize anything that is re-used between invokes."]}),(0,s.jsx)(d.SectionCode,{}),(0,s.jsxs)(e.p,{children:["One thing to note is the ",(0,s.jsx)(d.SectionLink,{focus:"1[3:13]",id:"focus://1[3:13]",children:(0,s.jsx)(e.code,{children:"tokio::main"})})," macro.  Macros in Rust are signals to the compiler to generate some code based upon the macros' definition. The tokio macro allows the ",(0,s.jsx)(d.SectionLink,{focus:"2[10:14]",id:"focus://2[10:14]",children:(0,s.jsx)(e.code,{children:"main"})})," function to run asynchronous, which is what the Lambda handler function requires."]}),(0,s.jsxs)(e.p,{children:["It's worth noting, that this ",(0,s.jsx)(d.SectionLink,{focus:"2[10:14]",id:"focus://2[10:14]",children:(0,s.jsx)(e.code,{children:"main"})})," function example would work for almost all Lambda Event Sources. The difference coming when moving on to the function_handler itself."]})]}),"\n",(0,s.jsxs)(d.Scrollycoding,{codeConfig:y,editorSteps:[{northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"async fn ",props:{style:{color:"#569CD6"}}},{content:"function_handler",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"event",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"LambdaEvent",props:{style:{color:"#4EC9B0"}}},{content:"<",props:{style:{color:"#D4D4D4"}}},{content:"KinesisEvent",props:{style:{color:"#4EC9B0"}}},{content:">) -> ",props:{style:{color:"#D4D4D4"}}},{content:"Result",props:{style:{color:"#4EC9B0"}}},{content:"<",props:{style:{color:"#D4D4D4"}}},{content:"KinesisEventResponse",props:{style:{color:"#4EC9B0"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"Error",props:{style:{color:"#4EC9B0"}}},{content:"> {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    ",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    Ok",props:{style:{color:"#4EC9B0"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"KinesisEventResponse",props:{style:{color:"#4EC9B0"}}},{content:"{",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        batch_item_failures",props:{style:{color:"#9CDCFE"}}},{content:",",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    })",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"}",props:{style:{color:"#D4D4D4"}}}]}],lang:"rust"},annotations:[]}]},{northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"async fn ",props:{style:{color:"#569CD6"}}},{content:"function_handler",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"event",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"LambdaEvent",props:{style:{color:"#4EC9B0"}}},{content:"<",props:{style:{color:"#D4D4D4"}}},{content:"KinesisEvent",props:{style:{color:"#4EC9B0"}}},{content:">)",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    -> ",props:{style:{color:"#D4D4D4"}}},{content:"Result",props:{style:{color:"#4EC9B0"}}},{content:"<",props:{style:{color:"#D4D4D4"}}},{content:"KinesisEventResponse",props:{style:{color:"#4EC9B0"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"Error",props:{style:{color:"#4EC9B0"}}},{content:"> {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    let mut ",props:{style:{color:"#569CD6"}}},{content:"batch_item_failures",props:{style:{color:"#9CDCFE"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"Vec",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"new",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    for ",props:{style:{color:"#C586C0"}}},{content:"message ",props:{style:{color:"#9CDCFE"}}},{content:"in",props:{style:{color:"#569CD6"}}},{content:" &",props:{style:{color:"#D4D4D4"}}},{content:"event",props:{style:{color:"#9CDCFE"}}},{content:".payload.records {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        let ",props:{style:{color:"#569CD6"}}},{content:"kinesis_sequence_number",props:{style:{color:"#9CDCFE"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"message",props:{style:{color:"#9CDCFE"}}},{content:".kinesis.sequence_number.",props:{style:{color:"#D4D4D4"}}},{content:"clone",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        let ",props:{style:{color:"#569CD6"}}},{content:"new_message",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"Result",props:{style:{color:"#4EC9B0"}}},{content:"<",props:{style:{color:"#D4D4D4"}}},{content:"NewSensorReading",props:{style:{color:"#4EC9B0"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"MessageParseError",props:{style:{color:"#4EC9B0"}}},{content:"> = ",props:{style:{color:"#D4D4D4"}}},{content:"InternalKinesisMessage",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"new",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"message",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"clone",props:{style:{color:"#DCDCAA"}}},{content:"()).",props:{style:{color:"#D4D4D4"}}},{content:"try_into",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        if ",props:{style:{color:"#C586C0"}}},{content:"new_message",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"is_err",props:{style:{color:"#DCDCAA"}}},{content:"() {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            batch_item_failures",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"push",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"KinesisBatchItemFailure",props:{style:{color:"#4EC9B0"}}},{content:"{",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"                item_identifier",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"kinesis_sequence_number",props:{style:{color:"#9CDCFE"}}}]},{tokens:[{content:"            });",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            continue",props:{style:{color:"#C586C0"}}},{content:";",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    Ok",props:{style:{color:"#4EC9B0"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"KinesisEventResponse",props:{style:{color:"#4EC9B0"}}},{content:"{",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        batch_item_failures",props:{style:{color:"#9CDCFE"}}},{content:",",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    })",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"}",props:{style:{color:"#D4D4D4"}}}]}],lang:"rust"},annotations:[]}],southPanel:void 0},{northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"async fn ",props:{style:{color:"#569CD6"}}},{content:"function_handler",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"event",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"LambdaEvent",props:{style:{color:"#4EC9B0"}}},{content:"<",props:{style:{color:"#D4D4D4"}}},{content:"KinesisEvent",props:{style:{color:"#4EC9B0"}}},{content:">) -> ",props:{style:{color:"#D4D4D4"}}},{content:"Result",props:{style:{color:"#4EC9B0"}}},{content:"<",props:{style:{color:"#D4D4D4"}}},{content:"KinesisEventResponse",props:{style:{color:"#4EC9B0"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"Error",props:{style:{color:"#4EC9B0"}}},{content:"> {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    let mut ",props:{style:{color:"#569CD6"}}},{content:"batch_item_failures",props:{style:{color:"#9CDCFE"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"Vec",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"new",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    for ",props:{style:{color:"#C586C0"}}},{content:"message ",props:{style:{color:"#9CDCFE"}}},{content:"in",props:{style:{color:"#569CD6"}}},{content:" &",props:{style:{color:"#D4D4D4"}}},{content:"event",props:{style:{color:"#9CDCFE"}}},{content:".payload.records {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        let ",props:{style:{color:"#569CD6"}}},{content:"kinesis_sequence_number",props:{style:{color:"#9CDCFE"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"message",props:{style:{color:"#9CDCFE"}}},{content:".kinesis.sequence_number.",props:{style:{color:"#D4D4D4"}}},{content:"clone",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        let ",props:{style:{color:"#569CD6"}}},{content:"new_message",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"Result",props:{style:{color:"#4EC9B0"}}},{content:"<",props:{style:{color:"#D4D4D4"}}},{content:"NewSensorReading",props:{style:{color:"#4EC9B0"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"MessageParseError",props:{style:{color:"#4EC9B0"}}},{content:"> ",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            = ",props:{style:{color:"#D4D4D4"}}},{content:"InternalKinesisMessage",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"new",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"message",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"clone",props:{style:{color:"#DCDCAA"}}},{content:"()).",props:{style:{color:"#D4D4D4"}}},{content:"try_into",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        if ",props:{style:{color:"#C586C0"}}},{content:"new_message",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"is_err",props:{style:{color:"#DCDCAA"}}},{content:"() {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            batch_item_failures",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"push",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"KinesisBatchItemFailure",props:{style:{color:"#4EC9B0"}}},{content:"{",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"                item_identifier",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"kinesis_sequence_number",props:{style:{color:"#9CDCFE"}}}]},{tokens:[{content:"            });",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            continue",props:{style:{color:"#C586C0"}}},{content:";",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        // Business logic goes here",props:{style:{color:"#6A9955"}}}]},{tokens:[{content:"        let ",props:{style:{color:"#569CD6"}}},{content:"handle_result",props:{style:{color:"#9CDCFE"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"NewSensorReadingHandler",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"handle",props:{style:{color:"#DCDCAA"}}},{content:"(&",props:{style:{color:"#D4D4D4"}}},{content:"new_message",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"unwrap",props:{style:{color:"#DCDCAA"}}},{content:"()).",props:{style:{color:"#D4D4D4"}}},{content:"await",props:{style:{color:"#C586C0"}}},{content:";",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        if ",props:{style:{color:"#C586C0"}}},{content:"handle_result",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"is_err",props:{style:{color:"#DCDCAA"}}},{content:"() {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            batch_item_failures",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"push",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"KinesisBatchItemFailure",props:{style:{color:"#4EC9B0"}}},{content:"{",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"                item_identifier",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"kinesis_sequence_number",props:{style:{color:"#9CDCFE"}}}]},{tokens:[{content:"            });",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            continue",props:{style:{color:"#C586C0"}}},{content:";",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    Ok",props:{style:{color:"#4EC9B0"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"KinesisEventResponse",props:{style:{color:"#4EC9B0"}}},{content:"{",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        batch_item_failures",props:{style:{color:"#9CDCFE"}}},{content:",",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    })",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"}",props:{style:{color:"#D4D4D4"}}}]}],lang:"rust"},annotations:[]}],southPanel:void 0}],children:[(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.p,{children:["The main bulk of a Kinesis sourced Lambda function is implemented in the ",(0,s.jsx)(d.SectionLink,{focus:"1[10:25]",id:"focus://1[10:25]",children:(0,s.jsx)(e.code,{children:"function_handler"})})," function. The first piece to note in this handler is that the event argument is typed to an ",(0,s.jsx)(d.SectionLink,{focus:"1[26:57]",id:"focus://1[26:57]",children:(0,s.jsx)(e.code,{children:"event"})}),". This event uses the ",(0,s.jsx)(e.a,{href:"https://docs.rs/aws_lambda_events/latest/aws_lambda_events/",children:"Lambda events Crate"})," which defines the struct definition for the record definition specified by AWS. As you are sourcing your function with SQS, this uses the ",(0,s.jsx)(e.code,{children:"Kinesis Event"})," type."]}),(0,s.jsx)(d.CodeSlot,{})]}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.p,{children:["As you learned earlier, Lambda receives messages from Kinesis in batches. When your function completes successfully, Lambda then deletes all the messages from that batch from the SQS queue. If your function errors, then the messages return to the queue. However, Lambda also supports the ability to return partial successes. For example, if your function receives 50 messages and 48 complete the position in the stream will move forward to the last successfully processed message. You do that, using the ",(0,s.jsx)(d.SectionLink,{focus:"2[15:36]",id:"focus://2[15:36]",children:(0,s.jsx)(e.code,{children:"KinesisEventResponse"})}),". The ",(0,s.jsx)(e.code,{children:"KinesisEventResponse"})," contains a single property named ",(0,s.jsx)(d.SectionLink,{focus:"19:21",id:"focus://19:21",children:(0,s.jsx)(e.code,{children:"batch_item_failures"})})," which is a Vector of the failed sequence numbers."]}),(0,s.jsx)(d.CodeSlot,{})]}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.p,{children:["Inside the for loop, you can handle individual messages. For re-usability, a custom ",(0,s.jsx)(d.SectionLink,{focus:"8",id:"focus://8",children:(0,s.jsx)(e.code,{children:"InternalKinesisMessage"})})," struct is used as a wrapper around the ",(0,s.jsx)(e.code,{children:"SqsMessage"})," type that comes from the ",(0,s.jsx)(e.a,{href:"https://docs.rs/aws_lambda_events/latest/aws_lambda_events/",children:"Lambda events Crate"}),". This allows the ",(0,s.jsx)(d.SectionLink,{focus:"8",id:"focus://8",children:(0,s.jsx)(e.code,{children:"try_into()"})})," function to be used to handle the conversion from the custom ",(0,s.jsx)(e.code,{children:"KinesisEventRecord"})," type into the ",(0,s.jsx)(e.code,{children:"NewSensorReading"})," custom to your application."]}),(0,s.jsxs)(e.p,{children:["You'll notice that if a failure occurs either in the ",(0,s.jsx)(d.SectionLink,{focus:"10",id:"focus://10",children:"initial message parsing"})," or the actual ",(0,s.jsx)(d.SectionLink,{focus:"20",id:"focus://20",children:"handling of the message"})," a new ",(0,s.jsx)(e.code,{children:"KinesisBatchItemFailure"})," is pushed onto the ",(0,s.jsx)(e.code,{children:"batch_item_failures"})," vector. This allows you to support partial completions in your Kinesis sourced Lambda functions."]}),(0,s.jsx)(d.CodeSlot,{})]})]}),"\n",(0,s.jsx)(e.h2,{id:"shared-code--reusability",children:"Shared Code & Reusability"}),"\n",(0,s.jsxs)(d.Section,{codeConfig:y,northPanel:{tabs:["lib.rs"],active:"lib.rs",heightRatio:1},files:[{name:"lib.rs",focus:"",code:{lines:[{tokens:[{content:"#[derive(",props:{style:{color:"#D4D4D4"}}},{content:"Deserialize",props:{style:{color:"#4EC9B0"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"Debug",props:{style:{color:"#4EC9B0"}}},{content:")]",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"#[serde(rename_all = ",props:{style:{color:"#D4D4D4"}}},{content:'"camelCase"',props:{style:{color:"#CE9178"}}},{content:")]",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"pub struct ",props:{style:{color:"#569CD6"}}},{content:"NewSensorReading",props:{style:{color:"#4EC9B0"}}},{content:" {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    pub ",props:{style:{color:"#569CD6"}}},{content:"temperature",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"f64",props:{style:{color:"#4EC9B0"}}},{content:",",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    pub ",props:{style:{color:"#569CD6"}}},{content:"reading_timestamp",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"i64",props:{style:{color:"#4EC9B0"}}}]},{tokens:[{content:"}",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"pub struct ",props:{style:{color:"#569CD6"}}},{content:"NewSensorReadingHandler",props:{style:{color:"#4EC9B0"}}},{content:" {}",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"impl ",props:{style:{color:"#569CD6"}}},{content:"NewSensorReadingHandler",props:{style:{color:"#4EC9B0"}}},{content:" {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    pub async fn ",props:{style:{color:"#569CD6"}}},{content:"handle",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"message",props:{style:{color:"#9CDCFE"}}},{content:": &",props:{style:{color:"#D4D4D4"}}},{content:"NewSensorReading",props:{style:{color:"#4EC9B0"}}},{content:") -> ",props:{style:{color:"#D4D4D4"}}},{content:"Result",props:{style:{color:"#4EC9B0"}}},{content:"<(), ()> {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        tracing",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"info!",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"New message is for temperature {} at time {}"',props:{style:{color:"#CE9178"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"message",props:{style:{color:"#9CDCFE"}}},{content:".temperature, ",props:{style:{color:"#D4D4D4"}}},{content:"message",props:{style:{color:"#9CDCFE"}}},{content:".reading_timestamp);",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        if ",props:{style:{color:"#C586C0"}}},{content:"message",props:{style:{color:"#9CDCFE"}}},{content:".temperature > ",props:{style:{color:"#D4D4D4"}}},{content:"100.00",props:{style:{color:"#B5CEA8"}}},{content:" {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            return ",props:{style:{color:"#C586C0"}}},{content:"Err",props:{style:{color:"#4EC9B0"}}},{content:"(());",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        Ok",props:{style:{color:"#4EC9B0"}}},{content:"(())",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"}",props:{style:{color:"#D4D4D4"}}}]}],lang:"rust"},annotations:[]}],children:[(0,s.jsxs)(e.p,{children:["The shared code in this example contains a custom ",(0,s.jsx)(d.SectionLink,{focus:"1:5",id:"focus://1:5",children:(0,s.jsx)(e.code,{children:"NewSensorReading"})})," struct representing the actual message put onto the stream. The shared code also contains a ",(0,s.jsx)(d.SectionLink,{focus:"8",id:"focus://8",children:(0,s.jsx)(e.code,{children:"NewSensorReadingHandler"})})," that contains a ",(0,s.jsxs)(d.SectionLink,{focus:"11:18",id:"focus://11:18",children:[(0,s.jsx)(e.code,{children:"handle"})," function"]}),", taking the ",(0,s.jsx)(e.code,{children:"NewSensorReading"})," struct as a input parameter."]}),(0,s.jsxs)(e.p,{children:["If you want to use this template in your own applications, replace the ",(0,s.jsx)(d.SectionLink,{focus:"1:5",id:"focus://1:5",children:(0,s.jsx)(e.code,{children:"NewSensorReading"})})," struct with your own custom struct and update the ",(0,s.jsxs)(d.SectionLink,{focus:"11:18",id:"focus://11:18",children:[(0,s.jsx)(e.code,{children:"handle"})," function"]})," with your custom business logic."]}),(0,s.jsx)(d.SectionCode,{})]}),"\n",(0,s.jsxs)(d.Section,{codeConfig:y,northPanel:{tabs:["lib.rs"],active:"lib.rs",heightRatio:1},files:[{name:"lib.rs",focus:"",code:{lines:[{tokens:[{content:"pub struct ",props:{style:{color:"#569CD6"}}},{content:"InternalKinesisMessage",props:{style:{color:"#4EC9B0"}}},{content:"{",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    message",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"KinesisEventRecord",props:{style:{color:"#4EC9B0"}}}]},{tokens:[{content:"}",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"impl ",props:{style:{color:"#569CD6"}}},{content:"InternalKinesisMessage",props:{style:{color:"#4EC9B0"}}},{content:"{",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    pub fn ",props:{style:{color:"#569CD6"}}},{content:"new",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"message",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"KinesisEventRecord",props:{style:{color:"#4EC9B0"}}},{content:") -> ",props:{style:{color:"#D4D4D4"}}},{content:"Self",props:{style:{color:"#569CD6"}}},{content:" {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        Self",props:{style:{color:"#569CD6"}}},{content:" {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            message",props:{style:{color:"#9CDCFE"}}}]},{tokens:[{content:"        }",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"}",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"impl ",props:{style:{color:"#569CD6"}}},{content:"TryFrom",props:{style:{color:"#4EC9B0"}}},{content:"<",props:{style:{color:"#D4D4D4"}}},{content:"InternalKinesisMessage",props:{style:{color:"#4EC9B0"}}},{content:"> ",props:{style:{color:"#D4D4D4"}}},{content:"for ",props:{style:{color:"#C586C0"}}},{content:"NewSensorReading",props:{style:{color:"#4EC9B0"}}},{content:" {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    type ",props:{style:{color:"#569CD6"}}},{content:"Error",props:{style:{color:"#4EC9B0"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"MessageParseError",props:{style:{color:"#4EC9B0"}}},{content:";",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    fn ",props:{style:{color:"#569CD6"}}},{content:"try_from",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"value",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"InternalKinesisMessage",props:{style:{color:"#4EC9B0"}}},{content:") -> ",props:{style:{color:"#D4D4D4"}}},{content:"Result",props:{style:{color:"#4EC9B0"}}},{content:"<",props:{style:{color:"#D4D4D4"}}},{content:"Self",props:{style:{color:"#569CD6"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"Self",props:{style:{color:"#569CD6"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"Error",props:{style:{color:"#4EC9B0"}}},{content:"> {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        let ",props:{style:{color:"#569CD6"}}},{content:"parsed_body",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"NewSensorReading ",props:{style:{color:"#4EC9B0"}}}]},{tokens:[{content:"            = ",props:{style:{color:"#D4D4D4"}}},{content:"serde_json",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"from_slice",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"value",props:{style:{color:"#9CDCFE"}}},{content:".message.kinesis.data.",props:{style:{color:"#D4D4D4"}}},{content:"0.",props:{style:{color:"#B5CEA8"}}},{content:"as_slice",props:{style:{color:"#DCDCAA"}}},{content:"())?;",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        Ok",props:{style:{color:"#4EC9B0"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"parsed_body",props:{style:{color:"#9CDCFE"}}},{content:")",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"}",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]}],lang:"rust"},annotations:[]}],children:[(0,s.jsxs)(e.p,{children:["The shared library also contains code to convert a ",(0,s.jsx)(e.code,{children:"KinesisEventRecord"})," into the custom ",(0,s.jsx)(e.code,{children:"NewSensorReading"})," struct. It does this using the ",(0,s.jsxs)(d.SectionLink,{focus:"13",id:"focus://13",children:[(0,s.jsx)(e.code,{children:"TryFrom"})," trait"]}),". Because the ",(0,s.jsx)(e.code,{children:"KinesisEventRecord"})," struct is defined in an external crate, the ",(0,s.jsxs)(d.SectionLink,{focus:"1:3",id:"focus://1:3",children:[(0,s.jsx)(e.code,{children:"InternalKinesisMessage"})," struct"]})," is used as a wrapper. Traits cannot be implemented for structs outside of the current crate."]}),(0,s.jsxs)(e.p,{children:["The actual contents of the record passed to your Lambda function is Base64 encoded. The ",(0,s.jsxs)(d.SectionLink,{focus:"18",id:"focus://18",children:[(0,s.jsx)(e.code,{children:"serde_json::from_slice"})," function is used to deserialize the payload directly into the custom ",(0,s.jsx)(e.code,{children:"NewSensorReading"})," type"]})]}),(0,s.jsxs)(e.p,{children:["You'll notice the ",(0,s.jsx)(d.SectionLink,{focus:"16:15",id:"focus://16:15",children:(0,s.jsx)(e.code,{children:"try_from"})})," function returns a custom ",(0,s.jsx)(e.code,{children:"MessageParseError"})," type depending if the message body is empty or the message fails to deserialize correctly."]}),(0,s.jsx)(d.SectionCode,{})]}),"\n",(0,s.jsx)(e.p,{children:"Congratulations, you now know how to implement a Kinesis sourced Lambda function in Rust and do that in a way that separates your Lambda handling code from your business logic."}),"\n",(0,s.jsxs)(e.p,{children:["You've also learned how you can use the ",(0,s.jsx)(e.code,{children:"KinesisEventResponse"})," struct to handle partial completions inside your message processing logic."]}),"\n",(0,s.jsx)(e.h2,{id:"deploy-your-own",children:"Deploy Your Own"}),"\n",(0,s.jsx)(e.p,{children:"If you want to deploy this exact example, clone the GitHub repo and run the below commands:"}),"\n",(0,s.jsx)(d.Code,{codeConfig:y,northPanel:{tabs:["deploy.sh"],active:"deploy.sh",heightRatio:1},files:[{name:"deploy.sh",focus:"",code:{lines:[{tokens:[{content:"cd ",props:{style:{color:"#DCDCAA"}}},{content:"templates/patterns/messaging-patterns/kinesis-message-processor",props:{style:{color:"#CE9178"}}}]},{tokens:[{content:"sam ",props:{style:{color:"#D4D4D4"}}},{content:"build",props:{style:{color:"#CE9178"}}}]},{tokens:[{content:"sam ",props:{style:{color:"#D4D4D4"}}},{content:"deploy",props:{style:{color:"#CE9178"}}}]}],lang:"bash"},annotations:[]}]}),"\n",(0,s.jsxs)(e.p,{children:["This pattern also ships with a small test utility that allows you to interact with Kinesis. Run the below commands to use the test utility, replacing the ",(0,s.jsx)(e.code,{children:"<STREAM_ARN>"})," with the URL that was output as part of the ",(0,s.jsx)(e.code,{children:"sam deploy"})," step:"]}),"\n",(0,s.jsx)(d.Code,{codeConfig:y,northPanel:{tabs:["test-utility.sh"],active:"test-utility.sh",heightRatio:1},files:[{name:"test-utility.sh",focus:"",code:{lines:[{tokens:[{content:"cd ",props:{style:{color:"#DCDCAA"}}},{content:"test-utility",props:{style:{color:"#CE9178"}}}]},{tokens:[{content:"cargo ",props:{style:{color:"#D4D4D4"}}},{content:"run --",props:{style:{color:"#CE9178"}}},{content:" <",props:{style:{color:"#D4D4D4"}}},{content:"STREAM_AR",props:{style:{color:"#CE9178"}}},{content:"N>",props:{style:{color:"#D4D4D4"}}}]}],lang:"bash"},annotations:[]}]}),"\n",(0,s.jsxs)(e.p,{children:["The test utility simulates a set of IoT devices sending temperature readings to Kinesis. It will send 10 records every 1 second. You can then use the ",(0,s.jsx)(e.code,{children:"sam logs"})," command to retrieve the latest log messages."]}),"\n",(0,s.jsxs)(e.p,{children:["Alternatively, you can then invoke the function using the below CLI command, replacing the ",(0,s.jsx)(e.code,{children:"<STREAM_ARN>"})," with the URL that was output as part of the ",(0,s.jsx)(e.code,{children:"sam deploy"})," step. The ",(0,s.jsx)(e.code,{children:"sam logs"})," command will grab the latest logs."]}),"\n",(0,s.jsx)(d.Code,{codeConfig:y,northPanel:{tabs:["test.sh"],active:"test.sh",heightRatio:1},files:[{name:"test.sh",focus:"",code:{lines:[{tokens:[{content:"aws ",props:{style:{color:"#D4D4D4"}}},{content:'kinesis put-record --data "eyJ0ZW1wZXJhdHVyZSI6IDg5LjksICJyZWFkaW5nVGltZXN0YW1wIjogODkyMzc0MiB9" --partition-key "sensor-1" --region eu-west-1 --profile dev --stream-arn',props:{style:{color:"#CE9178"}}},{content:" <",props:{style:{color:"#D4D4D4"}}},{content:"STREAM_AR",props:{style:{color:"#CE9178"}}},{content:"N>",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"sam ",props:{style:{color:"#D4D4D4"}}},{content:"logs",props:{style:{color:"#CE9178"}}}]}],lang:"bash"},annotations:[]}]})]})}const C=function(o={}){const{wrapper:e}=Object.assign({},(0,n.R)(),o.components);return e?(0,s.jsx)(e,Object.assign({},o,{children:(0,s.jsx)(u,o)})):u(o)};function m(o,e){throw new Error("Expected "+(e?"component":"object")+" `"+o+"` to be defined: you likely forgot to import, pass, or provide it.")}}}]);
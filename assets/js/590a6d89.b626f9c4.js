"use strict";(self.webpackChunkinteractive_docs=self.webpackChunkinteractive_docs||[]).push([[3055],{6054:(o,t,e)=>{e.r(t),e.d(t,{CH:()=>i,assets:()=>D,chCodeConfig:()=>y,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>p,toc:()=>a});e(6540);var n=e(4848),s=e(8453),r=e(4754);const c={sidebar_position:2,title:"DynamoDB Streams",description:"Handle table changes with a Lambda",keywords:["rust","lambda","dynamodb","change data capture"]},l=void 0,p={id:"patterns/database-patterns/ddb-basic-stream",title:"DynamoDB Streams",description:"Handle table changes with a Lambda",source:"@site/docs/patterns/database-patterns/ddb-basic-stream.md",sourceDirName:"patterns/database-patterns",slug:"/patterns/database-patterns/ddb-basic-stream",permalink:"/docs/patterns/database-patterns/ddb-basic-stream",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,title:"DynamoDB Streams",description:"Handle table changes with a Lambda",keywords:["rust","lambda","dynamodb","change data capture"]},sidebar:"tutorialSidebar",previous:{title:"DynamoDB Basic Operations",permalink:"/docs/patterns/database-patterns/ddb-basic-operations"},next:{title:"Messaging",permalink:"/docs/category/messaging"}},D={},a=[{value:"Sample Solution",id:"sample-solution",level:2},{value:"Main",id:"main",level:3},{value:"Handler",id:"handler",level:3},{value:"SampleModel",id:"samplemodel",level:3},{value:"Wrapping up",id:"wrapping-up",level:2},{value:"Congrats",id:"congrats",level:2}],i={annotations:r.hk,Section:r.wn,SectionLink:r.W_,SectionCode:r.bx},y={staticMediaQuery:"not screen, (max-width: 768px)",lineNumbers:void 0,showCopyButton:void 0,themeName:"dark-plus"};function d(o){const t=Object.assign({p:"p",h2:"h2",a:"a",ol:"ol",li:"li",h3:"h3",code:"code"},(0,s.R)(),o.components);return i||C("CH",!1),i.Section||C("CH.Section",!0),i.SectionCode||C("CH.SectionCode",!0),i.SectionLink||C("CH.SectionLink",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("style",{dangerouslySetInnerHTML:{__html:'[data-ch-theme="dark-plus"] {  --ch-t-colorScheme: dark;--ch-t-foreground: #D4D4D4;--ch-t-background: #1E1E1E;--ch-t-lighter-inlineBackground: #1e1e1ee6;--ch-t-editor-background: #1E1E1E;--ch-t-editor-foreground: #D4D4D4;--ch-t-editor-rangeHighlightBackground: #ffffff0b;--ch-t-editor-infoForeground: #3794FF;--ch-t-editor-selectionBackground: #264F78;--ch-t-focusBorder: #007FD4;--ch-t-tab-activeBackground: #1E1E1E;--ch-t-tab-activeForeground: #ffffff;--ch-t-tab-inactiveBackground: #2D2D2D;--ch-t-tab-inactiveForeground: #ffffff80;--ch-t-tab-border: #252526;--ch-t-tab-activeBorder: #1E1E1E;--ch-t-editorGroup-border: #444444;--ch-t-editorGroupHeader-tabsBackground: #252526;--ch-t-editorLineNumber-foreground: #858585;--ch-t-input-background: #3C3C3C;--ch-t-input-foreground: #D4D4D4;--ch-t-icon-foreground: #C5C5C5;--ch-t-sideBar-background: #252526;--ch-t-sideBar-foreground: #D4D4D4;--ch-t-sideBar-border: #252526;--ch-t-list-activeSelectionBackground: #094771;--ch-t-list-activeSelectionForeground: #fffffe;--ch-t-list-hoverBackground: #2A2D2E; }'}}),"\n",(0,n.jsx)(t.p,{children:"Serverless applications often use DynamoDB as their database technology.  DynamoDB handles tremendous scale, provides a simple yet powerful API, is 100% Serverless, and paired with the AWS SDK can be a key piece of an application.  DynamoDB can also serve as the starting point for a powerful architectual pattern called change data capture (CDC).  Change data capture is the process of propogating data changes so that other parts of the application can participate in those changes.  DynamoDB supports CDC by offering the capability called DynamoDB Streams.  Streams can be connected to a Lambda via a trigger or they can be connected to Kinesis.  This pattern below highlights how to handle CDC with DynamoDB via a Lambda trigger."}),"\n",(0,n.jsx)(t.h2,{id:"sample-solution",children:"Sample Solution"}),"\n",(0,n.jsxs)(t.p,{children:["A template for this pattern can be found under the ",(0,n.jsx)(t.a,{href:"https://github.com/serverlessdevelopers/serverless-rust/tree/main/templates/patterns/database-patterns/ddb-stream-lambda-handler/",children:"./templates"})," directory in the GitHub repo. You can use the template to get started building with DynamoDB Streams and Lambda."]}),"\n",(0,n.jsxs)(t.p,{children:["The record structure that comes from DynamoDB is consistent depending upon the change type that you have configured.  For more details about the shape of the payload, ",(0,n.jsx)(t.a,{href:"https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_streams_Record.html",children:"AWS' documentation"})," can describe the purpose of the fields and definitions."]}),"\n",(0,n.jsx)(t.p,{children:"Below are three main chunks of this sample solution."}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsx)(t.li,{children:"Main function"}),"\n",(0,n.jsx)(t.li,{children:"Lambda handler code"}),"\n",(0,n.jsx)(t.li,{children:"Parsing the record into a strongly typed struct."}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Oh, this performs blazingly fast, because it's Rust."}),"\n",(0,n.jsx)(t.h3,{id:"main",children:"Main"}),"\n",(0,n.jsxs)(i.Section,{codeConfig:y,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"#[tokio::main]",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"async fn ",props:{style:{color:"#569CD6"}}},{content:"main",props:{style:{color:"#DCDCAA"}}},{content:"() -> ",props:{style:{color:"#D4D4D4"}}},{content:"Result",props:{style:{color:"#4EC9B0"}}},{content:"<(), ",props:{style:{color:"#D4D4D4"}}},{content:"Error",props:{style:{color:"#4EC9B0"}}},{content:"> {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    tracing_subscriber",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"fmt",props:{style:{color:"#DCDCAA"}}},{content:"()",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"with_env_filter",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            EnvFilter",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"builder",props:{style:{color:"#DCDCAA"}}},{content:"()",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"                .",props:{style:{color:"#D4D4D4"}}},{content:"with_default_directive",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"LevelFilter",props:{style:{color:"#4EC9B0"}}},{content:"::INFO.",props:{style:{color:"#D4D4D4"}}},{content:"into",props:{style:{color:"#DCDCAA"}}},{content:"())",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"                .",props:{style:{color:"#D4D4D4"}}},{content:"from_env_lossy",props:{style:{color:"#DCDCAA"}}},{content:"(),",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        )",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"json",props:{style:{color:"#DCDCAA"}}},{content:"()",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"with_target",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"false",props:{style:{color:"#569CD6"}}},{content:")",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"without_time",props:{style:{color:"#DCDCAA"}}},{content:"()",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D4D4D4"}}},{content:"init",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    run",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"service_fn",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"function_handler",props:{style:{color:"#9CDCFE"}}},{content:")).",props:{style:{color:"#D4D4D4"}}},{content:"await",props:{style:{color:"#C586C0"}}}]},{tokens:[{content:"}",props:{style:{color:"#D4D4D4"}}}]}],lang:"rust"},annotations:[]}],children:[(0,n.jsxs)(t.p,{children:["Rust programs start off with a ",(0,n.jsx)(i.SectionLink,{focus:"2",id:"focus://2",children:(0,n.jsx)(t.code,{children:"main"})})," function.  The main function in this sample includes the ",(0,n.jsx)(i.SectionLink,{focus:"1",id:"focus://1",children:(0,n.jsx)(t.code,{children:"Tokio"})})," macro so that this main can run asynchronous code."]}),(0,n.jsx)(i.SectionCode,{})]}),"\n",(0,n.jsx)(t.h3,{id:"handler",children:"Handler"}),"\n",(0,n.jsxs)(i.Section,{codeConfig:y,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"async fn ",props:{style:{color:"#569CD6"}}},{content:"function_handler",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"event",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"LambdaEvent",props:{style:{color:"#4EC9B0"}}},{content:"<",props:{style:{color:"#D4D4D4"}}},{content:"aws_lambda_events",props:{style:{color:"#9CDCFE"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"event",props:{style:{color:"#9CDCFE"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"dynamodb",props:{style:{color:"#9CDCFE"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"Event",props:{style:{color:"#4EC9B0"}}},{content:">) -> ",props:{style:{color:"#D4D4D4"}}},{content:"Result",props:{style:{color:"#4EC9B0"}}},{content:"<(), ",props:{style:{color:"#D4D4D4"}}},{content:"Error",props:{style:{color:"#4EC9B0"}}},{content:"> {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    info!",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"(BatchSize)={:?}"',props:{style:{color:"#CE9178"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"event",props:{style:{color:"#9CDCFE"}}},{content:".payload.records.",props:{style:{color:"#D4D4D4"}}},{content:"len",props:{style:{color:"#DCDCAA"}}},{content:"());",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    // Extract some useful information from the request",props:{style:{color:"#6A9955"}}}]},{tokens:[{content:"    for ",props:{style:{color:"#C586C0"}}},{content:"record ",props:{style:{color:"#9CDCFE"}}},{content:"in ",props:{style:{color:"#569CD6"}}},{content:"event",props:{style:{color:"#9CDCFE"}}},{content:".payload.records {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        let ",props:{style:{color:"#569CD6"}}},{content:"m",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"SampleModel",props:{style:{color:"#4EC9B0"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"record",props:{style:{color:"#9CDCFE"}}},{content:".change.new_image.",props:{style:{color:"#D4D4D4"}}},{content:"into",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        info!",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"(Sample)={:?}"',props:{style:{color:"#CE9178"}}},{content:", ",props:{style:{color:"#D4D4D4"}}},{content:"m",props:{style:{color:"#9CDCFE"}}},{content:");",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    Ok",props:{style:{color:"#4EC9B0"}}},{content:"(())",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"}",props:{style:{color:"#D4D4D4"}}}]}],lang:"rust"},annotations:[]}],children:[(0,n.jsx)(t.p,{children:"The Lambda handler code is executed when events are received and is designed to process a batch of records.  The configuration on the DynamoDB Stream can be set to trigger the Lambda on 1 record or up to 100 records.  Either way, this will be packaged as an array."}),(0,n.jsxs)(t.p,{children:["The first piece to note in this handler is that the event argument is typed to an ",(0,n.jsx)(i.SectionLink,{focus:"1[26:87]",id:"focus://1[26:87]",children:(0,n.jsx)(t.code,{children:"event"})}),".  This event uses the ",(0,n.jsx)(t.a,{href:"https://docs.rs/aws_lambda_events/latest/aws_lambda_events/",children:"Lambda events Crate"})," which defines the struct definition for the record definition specified by AWS."]}),(0,n.jsx)(i.SectionCode,{}),(0,n.jsxs)(t.p,{children:["The second piece of this handler to highlight is the ",(0,n.jsx)(i.SectionLink,{focus:"5[53:59]",id:"focus://5[53:59]",children:(0,n.jsx)(t.code,{children:"into()"})})," call on the new_image. This code converts the DynamoDB Stream Record into the ",(0,n.jsx)(i.SectionLink,{focus:"5[14:26]",id:"focus://5[14:26]",children:(0,n.jsx)(t.code,{children:"SampleModel"})})]})]}),"\n",(0,n.jsx)(t.h3,{id:"samplemodel",children:"SampleModel"}),"\n",(0,n.jsxs)(i.Section,{codeConfig:y,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"impl ",props:{style:{color:"#569CD6"}}},{content:"From",props:{style:{color:"#4EC9B0"}}},{content:"<",props:{style:{color:"#D4D4D4"}}},{content:"serde_dynamo",props:{style:{color:"#9CDCFE"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"Item",props:{style:{color:"#4EC9B0"}}},{content:"> ",props:{style:{color:"#D4D4D4"}}},{content:"for ",props:{style:{color:"#C586C0"}}},{content:"SampleModel",props:{style:{color:"#4EC9B0"}}},{content:" {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    fn ",props:{style:{color:"#569CD6"}}},{content:"from",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"value",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"Item",props:{style:{color:"#4EC9B0"}}},{content:") -> ",props:{style:{color:"#D4D4D4"}}},{content:"Self",props:{style:{color:"#569CD6"}}},{content:" {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        let ",props:{style:{color:"#569CD6"}}},{content:"id_attr",props:{style:{color:"#9CDCFE"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"value",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"get",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"Id"',props:{style:{color:"#CE9178"}}},{content:");",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        let ",props:{style:{color:"#569CD6"}}},{content:"message_attr",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"Option",props:{style:{color:"#4EC9B0"}}},{content:"<&",props:{style:{color:"#D4D4D4"}}},{content:"AttributeValue",props:{style:{color:"#4EC9B0"}}},{content:"> = ",props:{style:{color:"#D4D4D4"}}},{content:"value",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"get",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"Message"',props:{style:{color:"#CE9178"}}},{content:");",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        let ",props:{style:{color:"#569CD6"}}},{content:"entity_type_attr",props:{style:{color:"#9CDCFE"}}},{content:": ",props:{style:{color:"#D4D4D4"}}},{content:"Option",props:{style:{color:"#4EC9B0"}}},{content:"<&",props:{style:{color:"#D4D4D4"}}},{content:"AttributeValue",props:{style:{color:"#4EC9B0"}}},{content:"> = ",props:{style:{color:"#D4D4D4"}}},{content:"value",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"get",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:'"EntityType"',props:{style:{color:"#CE9178"}}},{content:");",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        let mut ",props:{style:{color:"#569CD6"}}},{content:"id",props:{style:{color:"#9CDCFE"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"0",props:{style:{color:"#B5CEA8"}}},{content:";",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        let mut ",props:{style:{color:"#569CD6"}}},{content:"message",props:{style:{color:"#9CDCFE"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"String",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"new",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        let mut ",props:{style:{color:"#569CD6"}}},{content:"entity_type",props:{style:{color:"#9CDCFE"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"String",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"new",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        if ",props:{style:{color:"#C586C0"}}},{content:"let ",props:{style:{color:"#569CD6"}}},{content:"Some",props:{style:{color:"#4EC9B0"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"AttributeValue",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"N",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"n",props:{style:{color:"#9CDCFE"}}},{content:")) = ",props:{style:{color:"#D4D4D4"}}},{content:"id_attr",props:{style:{color:"#9CDCFE"}}},{content:" {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            if ",props:{style:{color:"#C586C0"}}},{content:"let ",props:{style:{color:"#569CD6"}}},{content:"Ok",props:{style:{color:"#4EC9B0"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"i",props:{style:{color:"#9CDCFE"}}},{content:") = ",props:{style:{color:"#D4D4D4"}}},{content:"n",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"parse",props:{style:{color:"#DCDCAA"}}},{content:"::<",props:{style:{color:"#D4D4D4"}}},{content:"i32",props:{style:{color:"#4EC9B0"}}},{content:">() {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"                id",props:{style:{color:"#9CDCFE"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"i",props:{style:{color:"#9CDCFE"}}},{content:";",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            }",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        if ",props:{style:{color:"#C586C0"}}},{content:"let ",props:{style:{color:"#569CD6"}}},{content:"Some",props:{style:{color:"#4EC9B0"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"AttributeValue",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"S",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"s",props:{style:{color:"#9CDCFE"}}},{content:")) = ",props:{style:{color:"#D4D4D4"}}},{content:"entity_type_attr",props:{style:{color:"#9CDCFE"}}},{content:" {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            entity_type",props:{style:{color:"#9CDCFE"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"s",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"clone",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        if ",props:{style:{color:"#C586C0"}}},{content:"let ",props:{style:{color:"#569CD6"}}},{content:"Some",props:{style:{color:"#4EC9B0"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"AttributeValue",props:{style:{color:"#4EC9B0"}}},{content:"::",props:{style:{color:"#D4D4D4"}}},{content:"S",props:{style:{color:"#DCDCAA"}}},{content:"(",props:{style:{color:"#D4D4D4"}}},{content:"s",props:{style:{color:"#9CDCFE"}}},{content:")) = ",props:{style:{color:"#D4D4D4"}}},{content:"message_attr",props:{style:{color:"#9CDCFE"}}},{content:" {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            message",props:{style:{color:"#9CDCFE"}}},{content:" = ",props:{style:{color:"#D4D4D4"}}},{content:"s",props:{style:{color:"#9CDCFE"}}},{content:".",props:{style:{color:"#D4D4D4"}}},{content:"clone",props:{style:{color:"#DCDCAA"}}},{content:"();",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"        SampleModel",props:{style:{color:"#4EC9B0"}}},{content:" {",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            id",props:{style:{color:"#9CDCFE"}}},{content:",",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            message",props:{style:{color:"#9CDCFE"}}},{content:",",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"            entity_type",props:{style:{color:"#9CDCFE"}}}]},{tokens:[{content:"        }",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#D4D4D4"}}}]},{tokens:[{content:"}",props:{style:{color:"#D4D4D4"}}}]}],lang:"rust"},annotations:[]}],children:[(0,n.jsx)(t.p,{children:"One of the interesting things about table design when implementing CDC is that any of your records will trigger the Lambda.  The more varied your items, the more varied your handler will have to be.  This needs to be taken into account when modeling your tables by either overloading keys in a single table design vs using multiple tables to represent your entities.  There's no right or wrong, just what is right for your needs."}),(0,n.jsx)(t.p,{children:"For the purposes of this sample, the sample model is defined like this."}),(0,n.jsx)(i.SectionCode,{}),(0,n.jsxs)(t.p,{children:["The model includes the ",(0,n.jsx)(i.SectionLink,{focus:"1",id:"focus://1",children:(0,n.jsx)(t.code,{children:"Serialize, Deserialie, and Debug macros"})})," which support taking the struct in and out of JSON."]}),(0,n.jsxs)(t.p,{children:["This struct then implements the ",(0,n.jsx)(t.code,{children:"into"})," trait in order to provide conversion from the DynamoDB Record into this SampleModel struct."]}),(0,n.jsx)(i.SectionCode,{})]}),"\n",(0,n.jsx)(t.h2,{id:"wrapping-up",children:"Wrapping up"}),"\n",(0,n.jsx)(t.p,{children:"This sample shows a basic implementation of handling an array of DynamoDB Stream Records and how to convert them into a well defined struct.  From this point, the options are endless."}),"\n",(0,n.jsx)(t.h2,{id:"congrats",children:"Congrats"}),"\n",(0,n.jsx)(t.p,{children:"Congratulations, you now have a starting point to build your Rust Lambdas for processing DynamoDB Change Data Capture Records!"})]})}const h=function(o={}){const{wrapper:t}=Object.assign({},(0,s.R)(),o.components);return t?(0,n.jsx)(t,Object.assign({},o,{children:(0,n.jsx)(d,o)})):d(o)};function C(o,t){throw new Error("Expected "+(t?"component":"object")+" `"+o+"` to be defined: you likely forgot to import, pass, or provide it.")}}}]);